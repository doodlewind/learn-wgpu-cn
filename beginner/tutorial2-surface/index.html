<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ä½¿ç”¨ Surface | å­¦ä¹  Wgpu</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    <meta property="article:modified_time" content="2022-04-24T02:02:09.000Z">
    <meta property="og:site_name" content="å­¦ä¹  Wgpu">
    <meta property="og:title" content="ä½¿ç”¨ Surface">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/beginner/tutorial2-surface/">
    <meta name="twitter:title" content="ä½¿ç”¨ Surface">
    <meta name="twitter:url" content="/beginner/tutorial2-surface/">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Benjamin Hansen">
    <meta name="twitter:creator" content="https://twitter.com/sotrh760">
    
    <link rel="preload" href="/learn-wgpu-cn/assets/css/0.styles.9735b80e.css" as="style"><link rel="preload" href="/learn-wgpu-cn/assets/js/app.4ff5359b.js" as="script"><link rel="preload" href="/learn-wgpu-cn/assets/js/4.7de995c5.js" as="script"><link rel="preload" href="/learn-wgpu-cn/assets/js/14.27582479.js" as="script"><link rel="preload" href="/learn-wgpu-cn/assets/js/25.997fcfd2.js" as="script"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/1.5a74b06a.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/10.7328fa8a.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/11.7ede3084.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/12.1618c781.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/13.8ed4ca2f.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/15.866ab171.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/16.65e20a6a.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/17.13dd0d98.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/18.0b7e17b3.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/19.e99c2c0b.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/2.1ff473f9.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/20.e60a9b69.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/21.640f3b7f.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/22.5e9abdb4.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/23.428ad388.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/24.ddf53bad.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/26.d0cb4a73.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/27.4b3c16d0.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/28.e072a203.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/29.126bb05e.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/30.661cb844.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/31.4d3f435a.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/32.e5012b0b.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/33.336b62e7.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/34.08650f25.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/35.20773e94.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/5.79560850.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/6.4f6de209.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/7.430483e0.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/8.24d6fd2e.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/9.0426af3e.js">
    <link rel="stylesheet" href="/learn-wgpu-cn/assets/css/0.styles.9735b80e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="inner"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/learn-wgpu-cn/" class="home-link router-link-active"><!----> <span class="site-name">å­¦ä¹  Wgpu</span></a> <div class="links"><!----> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></div></header> <div class="sidebar-mask"></div> <div class="docs-layout"><aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/learn-wgpu-cn/" aria-current="page" class="sidebar-link">ä»‹ç»</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>å…¥é—¨</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-wgpu-cn/beginner/tutorial1-window/" class="sidebar-link">ä¾èµ–ä¸çª—å£</a></li><li><a href="/learn-wgpu-cn/beginner/tutorial2-surface/" aria-current="page" class="active sidebar-link">ä½¿ç”¨ Surface</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial2-surface/#å…ˆåšäº›æ•´ç†-å»ºæ¨¡-state" class="sidebar-link">å…ˆåšäº›æ•´ç†ï¼šå»ºæ¨¡ State</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial2-surface/#state-new" class="sidebar-link">State::new()</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial2-surface/#resize" class="sidebar-link">resize()</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial2-surface/#input" class="sidebar-link">input()</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial2-surface/#update" class="sidebar-link">update()</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial2-surface/#render" class="sidebar-link">render()</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial2-surface/#å…³äº-renderpassdescriptor" class="sidebar-link">å…³äº RenderPassDescriptor</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial2-surface/#å…³äº-validation-error" class="sidebar-link">å…³äº Validation Error</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial2-surface/#å°æµ‹éªŒ" class="sidebar-link">å°æµ‹éªŒ</a></li></ul></li><li><a href="/learn-wgpu-cn/beginner/tutorial3-pipeline/" class="sidebar-link">ä½¿ç”¨ Pipeline</a></li><li><a href="/learn-wgpu-cn/beginner/tutorial4-buffer/" class="sidebar-link">é¡¶ç‚¹ç¼“å†²åŒºä¸ç´¢å¼•ç¼“å†²åŒº</a></li><li><a href="/learn-wgpu-cn/beginner/tutorial5-textures/" class="sidebar-link">çº¹ç†ä¸ BindGroup</a></li><li><a href="/learn-wgpu-cn/beginner/tutorial6-uniforms/" class="sidebar-link">Uniform ç¼“å†²åŒºä¸ 3D ç›¸æœº</a></li><li><a href="/learn-wgpu-cn/beginner/tutorial7-instancing/" class="sidebar-link">å®ä¾‹åŒ–ç»˜åˆ¶</a></li><li><a href="/learn-wgpu-cn/beginner/tutorial8-depth/" class="sidebar-link">æ·±åº¦ç¼“å†²åŒº</a></li><li><a href="/learn-wgpu-cn/beginner/tutorial9-models/" class="sidebar-link">åŠ è½½æ¨¡å‹</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>è¿›é˜¶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-wgpu-cn/intermediate/tutorial10-lighting/" class="sidebar-link">ğŸš§ å¤„ç†å…‰ç…§æ•ˆæœ</a></li><li><a href="/learn-wgpu-cn/intermediate/tutorial11-normals/" class="sidebar-link">ğŸš§ æ³•çº¿è´´å›¾</a></li><li><a href="/learn-wgpu-cn/intermediate/tutorial12-camera/" class="sidebar-link">ğŸš§ æ›´å¥½çš„ç›¸æœº</a></li><li><a href="/learn-wgpu-cn/intermediate/tutorial13-threading/" class="sidebar-link">ğŸš§ åŸºäº Wgpu å’Œ Rayon çš„å¤šçº¿ç¨‹</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ¡ˆä¾‹å±•ç¤º</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ›´æ–°åŠ¨æ€</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ä½¿ç”¨-surface"><a href="#ä½¿ç”¨-surface" class="header-anchor">#</a> ä½¿ç”¨ Surface</h1> <h2 id="å…ˆåšäº›æ•´ç†-å»ºæ¨¡-state"><a href="#å…ˆåšäº›æ•´ç†-å»ºæ¨¡-state" class="header-anchor">#</a> å…ˆåšäº›æ•´ç†ï¼šå»ºæ¨¡ State</h2> <p>ä¸ºæ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬å°†æŠŠæ‰€æœ‰çš„å­—æ®µæ‰“åŒ…åœ¨ä¸€ä¸ª struct å†…ï¼Œå¹¶åœ¨å…¶ä¸Šæ·»åŠ ä¸€äº›æ–¹æ³•ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// main.rs</span>
<span class="token keyword">use</span> <span class="token namespace">winit<span class="token punctuation">::</span>window<span class="token punctuation">::</span></span><span class="token class-name">Window</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token type-definition class-name">State</span> <span class="token punctuation">{</span>
    surface<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Surface</span><span class="token punctuation">,</span>
    device<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Device</span><span class="token punctuation">,</span>
    queue<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Queue</span><span class="token punctuation">,</span>
    config<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">SurfaceConfiguration</span><span class="token punctuation">,</span>
    size<span class="token punctuation">:</span> <span class="token namespace">winit<span class="token punctuation">::</span>dpi<span class="token punctuation">::</span></span><span class="token class-name">PhysicalSize</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">State</span> <span class="token punctuation">{</span>
    <span class="token comment">// æŸäº› wgpu ç±»å‹éœ€è¦ä½¿ç”¨å¼‚æ­¥ä»£ç æ‰èƒ½åˆ›å»º</span>
    <span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>window<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Window</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token macro property">todo!</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">resize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> new_size<span class="token punctuation">:</span> <span class="token namespace">winit<span class="token punctuation">::</span>dpi<span class="token punctuation">::</span></span><span class="token class-name">PhysicalSize</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">todo!</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">input</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> event<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">WindowEvent</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">bool</span> <span class="token punctuation">{</span>
        <span class="token macro property">todo!</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token macro property">todo!</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> <span class="token function-definition function">render</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">SurfaceError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token macro property">todo!</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ­¤å¤„ä¼šæ¦‚è¿°æ€§ä»‹ç» <code>State</code> ä¸‹çš„å­—æ®µã€‚å½“åç»­ç« èŠ‚ä¸­è§£é‡Šè¿™äº›æ–¹æ³•èƒŒåçš„ä»£ç æ—¶ï¼Œå®ƒä»¬çš„æ‹†åˆ†ä¼šæ˜¾å¾—æ›´åŠ åˆç†ã€‚</p> <h2 id="state-new"><a href="#state-new" class="header-anchor">#</a> State::new()</h2> <p>è¿™éƒ¨åˆ†ä»£ç éå¸¸ç›´æ¥ï¼Œä½†æˆ‘ä»¬å¯ä»¥å¯¹å®ƒè¿›è¡Œä¸€äº›æ‹†è§£ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">impl</span> <span class="token class-name">State</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>window<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Window</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> size <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">inner_size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// instance å˜é‡æ˜¯åˆ° GPU çš„ handle</span>
        <span class="token comment">// Backends::all å¯¹åº” Vulkan + Metal + DX12 + æµè§ˆå™¨çš„ WebGPU</span>
        <span class="token keyword">let</span> instance <span class="token operator">=</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Instance</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Backends</span><span class="token punctuation">::</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> surface <span class="token operator">=</span> <span class="token keyword">unsafe</span> <span class="token punctuation">{</span> instance<span class="token punctuation">.</span><span class="token function">create_surface</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> adapter <span class="token operator">=</span> instance<span class="token punctuation">.</span><span class="token function">request_adapter</span><span class="token punctuation">(</span>
            <span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">RequestAdapterOptions</span> <span class="token punctuation">{</span>
                power_preference<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">PowerPreference</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                compatible_surface<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>surface<span class="token punctuation">)</span><span class="token punctuation">,</span>
                force_fallback_adapter<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="instance-ä¸-adapter"><a href="#instance-ä¸-adapter" class="header-anchor">#</a> Instance ä¸ Adapter</h3> <p><code>instance</code> æ˜¯ä½¿ç”¨ wgpu æ—¶æ‰€éœ€åˆ›å»ºçš„ç¬¬ä¸€ä¸ªå®ä½“ï¼Œå…¶ä¸»è¦ç”¨é€”æ˜¯åˆ›å»º <code>Adapter</code> å’Œ <code>Surface</code>ã€‚</p> <p><code>adapter</code>ï¼ˆé€‚é…å™¨ï¼‰æ˜¯æŒ‡å‘å®é™…æ˜¾å¡çš„ä¸€ä¸ª handleã€‚æˆ‘ä»¬å¯ä»¥ç”¨å®ƒè·å–å…³äºæ˜¾å¡çš„ä¿¡æ¯ï¼Œä¾‹å¦‚æ˜¾å¡åç§°ä¸å…¶æ‰€é€‚é…åˆ°çš„åç«¯ç­‰ã€‚ç¨åæˆ‘ä»¬ä¼šç”¨å®ƒæ¥åˆ›å»º <code>Device</code> å’Œ <code>Queue</code>ã€‚åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬éœ€è¦å…ˆè®¨è®ºä¸€ä¸‹ <code>RequestAdapterOptions</code> æ‰€æ¶‰åŠçš„å­—æ®µã€‚</p> <ul><li><code>power_preference</code> å‚æ•°æœ‰ä¸¤ä¸ªå¯é€‰é¡¹ï¼š<code>LowPower</code> å’Œ <code>HighPerformance</code>ã€‚é€‰æ‹© <code>LowPower</code> æ—¶å°†å¯¹åº”ä¸€ä¸ªæœ‰åˆ©äºç”µæ± ç»­èˆªçš„é€‚é…å™¨ï¼ˆå¦‚é›†æˆæ˜¾å¡ï¼‰ã€‚ç›¸åº”åœ°ï¼Œ<code>HighPerformance</code> å¯¹åº”çš„é€‚é…å™¨å°†æŒ‡å‘ç‹¬ç«‹æ˜¾å¡è¿™æ ·æ›´è€—ç”µä½†æ€§èƒ½æ›´å¼ºçš„ GPUã€‚å¦‚æœä¸å­˜åœ¨ç¬¦åˆ <code>HighPerformance</code> é€‰é¡¹çš„é€‚é…å™¨ï¼Œwgpu å°†é€‰æ‹© <code>LowPower</code>ã€‚</li> <li><code>compatible_surface</code> å­—æ®µè¦æ±‚ wgpu æ‰€æ‰¾åˆ°çš„é€‚é…å™¨åº”å½“èƒ½ä¸æ­¤å¤„æ‰€ä¼ å…¥çš„ surface å…¼å®¹ã€‚</li> <li><code>force_fallback_adapter</code> å¼ºåˆ¶ wgpu é€‰æ‹©ä¸€ä¸ªèƒ½åœ¨æ‰€æœ‰ç¡¬ä»¶ä¸Šå·¥ä½œçš„é€‚é…å™¨ã€‚è¿™é€šå¸¸è¡¨æ˜æ¸²æŸ“åç«¯å°†ä½¿ç”¨ä¸€ä¸ªã€Œè½¯æ¸²æŸ“ã€ç³»ç»Ÿï¼Œè€Œé GPU è¿™æ ·çš„ç¡¬ä»¶ã€‚</li></ul> <div class="note"><p>æ­¤å¤„æˆ‘ä»¬ä¼ é€’ç»™ <code>request_adapter</code> çš„é€‰é¡¹æœªå¿…èƒ½å¯¹æ‰€æœ‰è®¾å¤‡ç”Ÿæ•ˆï¼Œä½†åº”å½“èƒ½åœ¨å¤§å¤šæ•°è®¾å¤‡ä¸Šå¯ç”¨ã€‚å¦‚æœ wgpu æ‰¾ä¸åˆ°ç¬¦åˆè¦æ±‚çš„é€‚é…å™¨ï¼Œ<code>request_adapter</code> å°†è¿”å› <code>None</code>ã€‚å¦‚æœä½ æƒ³è·å¾—æŸä¸ªç‰¹å®šåç«¯æ‰€æ”¯æŒçš„å…¨éƒ¨é€‚é…å™¨ï¼Œå¯ä»¥ä½¿ç”¨ <code>enumerate_adapters</code>ã€‚å®ƒä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå¯ä»¥éå†æ£€æŸ¥å…¶ä¸­æ˜¯å¦å­˜åœ¨ç¬¦åˆè¦æ±‚ çš„é€‚é…å™¨ã€‚</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">let</span> adapter <span class="token operator">=</span> instance
    <span class="token punctuation">.</span><span class="token function">enumerate_adapters</span><span class="token punctuation">(</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Backends</span><span class="token punctuation">::</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>adapter<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token comment">// æ£€æŸ¥è¯¥é€‚é…å™¨æ˜¯å¦æ”¯æŒæˆ‘ä»¬çš„ surface</span>
        surface<span class="token punctuation">.</span><span class="token function">get_preferred_format</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>adapter<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is_some</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>è¿˜æœ‰ä¸€ç‚¹å€¼å¾—æ³¨æ„ï¼š<code>Adapter</code> æ˜¯å›ºå®šäºæŸä¸ªç‰¹å®šåç«¯çš„ã€‚å¦‚æœä½ åœ¨ Windows ç³»ç»Ÿä¸Šæœ‰ä¸¤å—æ˜¾å¡ï¼Œé‚£ä¹ˆä½ è‡³å°‘å°±æœ‰ 4 ä¸ªé€‚é…å™¨å¯ä»¥ä½¿ç”¨ï¼Œå…¶ä¸­ä¸¤ä¸ªæ”¯æŒ Vulkanï¼Œä¸¤ä¸ªæ”¯æŒ DirectXã€‚</p> <p>å¦‚æœæƒ³çŸ¥é“æ›´å¤šç”¨äºæ”¹è¿›é€‚é…å™¨æœç´¢è¿‡ç¨‹çš„å­—æ®µï¼Œ<a href="https://docs.rs/wgpu/0.12.0/wgpu/struct.Adapter.html" target="_blank" rel="noopener noreferrer">è¯·å‚è§æ–‡æ¡£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p></div> <h3 id="surface"><a href="#surface" class="header-anchor">#</a> Surface</h3> <p><code>surface</code> æ˜¯æˆ‘ä»¬æ‰€ç»˜åˆ¶çª—å£çš„ä¸€éƒ¨åˆ†ï¼Œéœ€è¦é€šè¿‡å®ƒæ¥å°†å†…å®¹ä¸Šå±ã€‚ä¸ºæ­¤æˆ‘ä»¬çš„ <code>window</code> éœ€è¦å®ç° <a href="https://crates.io/crates/raw-window-handle" target="_blank" rel="noopener noreferrer">raw-window-handle<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸­çš„<code>HasRawWindowHandle</code> trait æ¥åˆ›å»º surfaceã€‚æ‰€å¹¸ winit çš„ <code>Window</code> ç¬¦åˆè¿™ä¸ªè¦æ±‚ã€‚å¦å¤–æˆ‘ä»¬è¿˜éœ€è¦ç”¨ surface æ¥è¯·æ±‚ <code>adapter</code>ã€‚</p> <h3 id="device-ä¸-queue"><a href="#device-ä¸-queue" class="header-anchor">#</a> Device ä¸ Queue</h3> <p>æˆ‘ä»¬å¯ä»¥ç”¨ <code>adapter</code> æ¥åˆ›å»º <code>device</code> å’Œ <code>queue</code>ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>        <span class="token keyword">let</span> <span class="token punctuation">(</span>device<span class="token punctuation">,</span> queue<span class="token punctuation">)</span> <span class="token operator">=</span> adapter<span class="token punctuation">.</span><span class="token function">request_device</span><span class="token punctuation">(</span>
            <span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">DeviceDescriptor</span> <span class="token punctuation">{</span>
                features<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Features</span><span class="token punctuation">::</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                limits<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Limits</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                label<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token comment">// æ˜¯å¦è¿½è¸ª API è°ƒç”¨è·¯å¾„</span>
        <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">await</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>DeviceDescriptor</code> ä¸Šçš„ <code>features</code> å­—æ®µå…è®¸æˆ‘ä»¬æŒ‡å®šæˆ‘ä»¬æƒ³è¦çš„é¢å¤–ç‰¹æ€§ã€‚å¯¹ç°åœ¨è¿™ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç”¨åˆ°é¢å¤–çš„ç‰¹æ€§ã€‚</p> <div class="note"><p>ä½ çš„æ˜¾å¡ä¼šé™åˆ¶ä½ å¯ä»¥ä½¿ç”¨çš„ç‰¹æ€§ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨æŸäº›é«˜çº§ç‰¹æ€§ï¼Œé‚£å¯èƒ½éœ€è¦é™åˆ¶åº”ç”¨æ‰€æ”¯æŒçš„è®¾å¤‡ï¼Œæˆ–å®ç°å˜é€šæ–¹æ¡ˆã€‚</p> <p>ä½ å¯ä»¥ç”¨ <code>adapter.features()</code> æˆ– <code>device.features()</code> è·å¾—è®¾å¤‡æ‰€æ”¯æŒç‰¹æ€§çš„åˆ—è¡¨ã€‚å¯ä»¥åœ¨<a href="https://docs.rs/wgpu/0.12.0/wgpu/struct.Features.html" target="_blank" rel="noopener noreferrer">è¿™é‡Œ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>æŸ¥çœ‹å®Œæ•´çš„ç‰¹æ€§åˆ—è¡¨ã€‚</p></div> <p><code>limits</code> å­—æ®µæè¿°äº†å¯¹æˆ‘ä»¬æ‰€èƒ½åˆ›å»ºçš„æŸäº›èµ„æºç±»å‹çš„é™åˆ¶ã€‚æˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨é»˜è®¤å€¼ï¼Œè¿™æ ·å¯ä»¥æ”¯æŒå¤§å¤šæ•°è®¾å¤‡ã€‚å¯ä»¥åœ¨<a href="https://docs.rs/wgpu/0.12.0/wgpu/struct.Limits.html" target="_blank" rel="noopener noreferrer">è¿™é‡Œ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>æŸ¥çœ‹è¯¦ç»†çš„é™åˆ¶æƒ…å†µã€‚</p> <div class="language-rust extra-class"><pre class="language-rust"><code>        <span class="token keyword">let</span> config <span class="token operator">=</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">SurfaceConfiguration</span> <span class="token punctuation">{</span>
            usage<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureUsages</span><span class="token punctuation">::</span><span class="token constant">RENDER_ATTACHMENT</span><span class="token punctuation">,</span>
            format<span class="token punctuation">:</span> surface<span class="token punctuation">.</span><span class="token function">get_preferred_format</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>adapter<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            width<span class="token punctuation">:</span> size<span class="token punctuation">.</span>width<span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> size<span class="token punctuation">.</span>height<span class="token punctuation">,</span>
            present_mode<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">PresentMode</span><span class="token punctuation">::</span><span class="token class-name">Fifo</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        surface<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>device<span class="token punctuation">,</span> <span class="token operator">&amp;</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è¿™é‡Œæˆ‘ä»¬è¦ä¸º surface å®šä¹‰ä¸€ä»½é…ç½®ï¼Œä»¥æ­¤ç¡®å®š surface å¦‚ä½•åˆ›å»ºå…¶åº•å±‚çš„ <code>SurfaceTexture</code>ã€‚æˆ‘ä»¬ä¼šç­‰åˆ°åç»­ä»‹ç» <code>render</code> å‡½æ•°æ—¶å†è®¨è®º <code>SurfaceTexture</code> çš„é—®é¢˜ã€‚ç°åœ¨æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è¿™ä»½é…ç½®ä¸­çš„å­—æ®µã€‚</p> <p><code>usage</code> å­—æ®µç”¨äºå®šä¹‰åº”å¦‚ä½•ä½¿ç”¨ <code>SurfaceTextures</code>ã€‚<code>RENDER_ATTACHMENT</code> è¡¨æ˜çº¹ç†å°†ç”¨æ¥ä¸Šå±ï¼ˆæˆ‘ä»¬å°†åœ¨åé¢ä»‹ç»å…¶ä»–çš„ <code>TextureUsage</code>ï¼‰ã€‚</p> <p><code>format</code> å­—æ®µå®šä¹‰äº† <code>SurfaceTexture</code> åœ¨ GPU ä¸Šçš„å­˜å‚¨æ–¹å¼ã€‚ä¸åŒçš„æ˜¾ç¤ºå™¨ä¼šåå¥½ä¸åŒçš„æ ¼å¼ã€‚ä¸ºæ­¤æˆ‘ä»¬ä½¿ç”¨ <code>surface.get_preferred_format(&amp;adapter)</code> æ¥åŸºäºå½“å‰æ˜¾ç¤ºå™¨è®¡ç®—å‡ºå¯¹åº”çš„æœ€ä½³æ ¼å¼ã€‚</p> <p><code>width</code> å’Œ <code>height</code> æ˜¯ <code>SurfaceTexture</code> çš„å®½åº¦å’Œé«˜åº¦ï¼ˆå•ä½ä¸ºåƒç´ ï¼‰ã€‚å®ƒä»¬é€šå¸¸åº”ç­‰äºçª—å£çš„å®½åº¦å’Œé«˜åº¦ã€‚</p> <div class="warning">
è¯·ç¡®ä¿ <code>SurfaceTexture</code> çš„å®½é«˜ä¸ä¸º 0ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´åº”ç”¨å´©æºƒã€‚
</div> <p><code>present_mode</code> ä½¿ç”¨ <code>wgpu::PresentMode</code> æšä¸¾å€¼æ¥ç¡®å®šåº”å¦‚ä½•å°† surface åŒæ­¥åˆ°æ˜¾ç¤ºå™¨ä¸Šã€‚å¯¹äºæˆ‘ä»¬æ‰€é€‰æ‹©çš„ <code>FIFO</code> é€‰é¡¹ï¼Œå…¶å«ä¹‰æ˜¯å°†æ˜¾ç¤ºé€Ÿç‡é™åˆ¶ä¸ºæ˜¾ç¤ºå™¨çš„å¸§é€Ÿç‡ã€‚å®é™…ä¸Šè¿™å°±æ˜¯ VSyncï¼Œä¹Ÿæ˜¯ç§»åŠ¨è®¾å¤‡ä¸Šæœ€ç†æƒ³çš„æ¨¡å¼ã€‚å¯¹äºå…¶ä»–é€‰é¡¹å¯ä»¥<a href="https://docs.rs/wgpu/0.12.0/wgpu/enum.PresentMode.html" target="_blank" rel="noopener noreferrer">å‚è§æ–‡æ¡£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <p>ç°åœ¨æˆ‘ä»¬å·²ç»é…ç½®å¥½äº† surfaceï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æ–¹æ³•çš„æœ«å°¾æ·»åŠ ä¸‹é¢è¿™äº›æ–°å­—æ®µäº†ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            surface<span class="token punctuation">,</span>
            device<span class="token punctuation">,</span>
            queue<span class="token punctuation">,</span>
            config<span class="token punctuation">,</span>
            size<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœ¨è¿›å…¥äº‹ä»¶å¾ªç¯å‰ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸»æ–¹æ³•ä¸­åšå¦‚ä¸‹è°ƒç”¨ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// State::new ä½¿ç”¨äº†å¼‚æ­¥ä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€ç­‰å¾…å…¶å®Œæˆ</span>
<span class="token keyword">let</span> <span class="token keyword">mut</span> state <span class="token operator">=</span> <span class="token namespace">pollster<span class="token punctuation">::</span></span><span class="token function">block_on</span><span class="token punctuation">(</span><span class="token class-name">State</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>window<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="note"><p>ä½ å¯ä»¥ç”¨å½¢å¦‚ <a href="https://docs.rs/async_std" target="_blank" rel="noopener noreferrer">async_std<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å’Œ <a href="https://docs.rs/tokio" target="_blank" rel="noopener noreferrer">tokio<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> è¿™æ ·è¾ƒé‡çš„åº“æ¥è®© main å‡½æ•°æ”¯æŒå¼‚æ­¥ï¼Œè¿™æ ·å°±å¯ä»¥ await æŸä¸ª future äº†ã€‚ç¬”è€…é€‰æ‹©ä¸ä½¿ç”¨è¿™äº›åº“ï¼Œæ˜¯å› ä¸ºæœ¬æ•™ç¨‹å¹¶éæ¶‰åŠå¼‚æ­¥åº”ç”¨å¼€å‘ï¼Œå¹¶ä¸”ç”± wgpu æ‰€åˆ›å»ºçš„ future æ— éœ€<a href="https://rust-lang.github.io/async-book/08_ecosystem/00_chapter.html#determining-ecosystem-compatibility" target="_blank" rel="noopener noreferrer">ç‰¹æ®Šæ‰§è¡Œå™¨çš„æ”¯æŒ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦ä¸€äº›æ–¹æ³•æ¥ä¸ wgpu çš„å¼‚æ­¥å‡½æ•°è¿›è¡Œäº¤äº’ï¼Œè€Œ <a href="https://docs.rs/pollster" target="_blank" rel="noopener noreferrer">pollster crate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å°±è¶³ä»¥æ»¡è¶³è¿™ä¸ªéœ€æ±‚äº†ã€‚</p></div> <h2 id="resize"><a href="#resize" class="header-anchor">#</a> resize()</h2> <p>å¦‚æœæƒ³æ”¯æŒè°ƒæ•´åº”ç”¨çš„çª—å£å¤§å°ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ¯æ¬¡çª—å£å°ºå¯¸æ”¹å˜æ—¶é‡æ–°é…ç½® <code>surface</code>ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œæˆ‘ä»¬æ‰åŒæ—¶å­˜å‚¨äº†ç‰©ç† <code>size</code> å’Œç”¨äºé…ç½® <code>surface</code> çš„ <code>config</code>ã€‚æœ‰äº†å®ƒä»¬åï¼Œresize æ–¹æ³•çš„å®ç°å°±éå¸¸ç®€å•äº†ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// impl State</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">resize</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> new_size<span class="token punctuation">:</span> <span class="token namespace">winit<span class="token punctuation">::</span>dpi<span class="token punctuation">::</span></span><span class="token class-name">PhysicalSize</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> new_size<span class="token punctuation">.</span>width <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> new_size<span class="token punctuation">.</span>height <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>size <span class="token operator">=</span> new_size<span class="token punctuation">;</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>config<span class="token punctuation">.</span>width <span class="token operator">=</span> new_size<span class="token punctuation">.</span>width<span class="token punctuation">;</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>config<span class="token punctuation">.</span>height <span class="token operator">=</span> new_size<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>surface<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>device<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸Šè¿°ä»£ç ä¸æœ€åˆçš„ <code>surface</code> é…ç½®è¿‡ç¨‹æ²¡æœ‰å®è´¨æ€§çš„å·®å¼‚ï¼Œæ•…æ­¤å¤„ä¸å†èµ˜è¿°ã€‚</p> <p>åœ¨ <code>main()</code> å‡½æ•°çš„äº‹ä»¶å¾ªç¯ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»¥ä¸‹äº‹ä»¶å‘ç”Ÿæ—¶è°ƒç”¨è¯¥æ–¹æ³•ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">match</span> event <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>

    <span class="token punctuation">}</span> <span class="token keyword">if</span> window_id <span class="token operator">==</span> window<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">if</span> <span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token function">input</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> event <span class="token punctuation">{</span>
            <span class="token comment">// ...</span>

            <span class="token class-name">WindowEvent</span><span class="token punctuation">::</span><span class="token class-name">Resized</span><span class="token punctuation">(</span>physical_size<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                state<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token operator">*</span>physical_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">WindowEvent</span><span class="token punctuation">::</span><span class="token class-name">ScaleFactorChanged</span> <span class="token punctuation">{</span> new_inner_size<span class="token punctuation">,</span> <span class="token punctuation">..</span> <span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token comment">// new_inner_size æ˜¯ &amp;&amp;mut ç±»å‹ï¼Œå› æ­¤éœ€è¦è§£å¼•ç”¨ä¸¤æ¬¡</span>
                state<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token operator">*</span>new_inner_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="input"><a href="#input" class="header-anchor">#</a> input()</h2> <p><code>input()</code> è¿”å›ä¸€ä¸ª <code>bool</code> æ¥è¡¨ç¤ºæŸäº‹ä»¶æ˜¯å¦å·²è¢«å®Œå…¨å¤„ç†ã€‚å¦‚æœè¯¥æ–¹æ³•è¿”å› <code>true</code>ï¼Œä¸»å¾ªç¯å°†ä¸å†ç»§ç»­å¤„ç†è¯¥äº‹ä»¶ã€‚</p> <p>ç”±äºç›®å‰è¿˜æ²¡æœ‰ä»»ä½•éœ€è¦æ•è·çš„äº‹ä»¶ï¼Œç°åœ¨æˆ‘ä»¬åªéœ€åœ¨æ­¤è¿”å› false å³å¯ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// impl State</span>
<span class="token keyword">fn</span> <span class="token function-definition function">input</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">,</span> event<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">WindowEvent</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">bool</span> <span class="token punctuation">{</span>
    <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¦å¤–æˆ‘ä»¬è¿˜éœ€è¦åœ¨äº‹ä»¶å¾ªç¯ä¸­å†å¤šåšä¸€ç‚¹å·¥ä½œã€‚å†åŠ ä¸Šä¹‹å‰çš„ä¿®æ”¹ï¼Œæœ€åçš„äº‹ä»¶å¾ªç¯çœ‹èµ·æ¥åº”è¯¥åƒè¿™æ ·ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// main()</span>
event_loop<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token keyword">move</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>event<span class="token punctuation">,</span> _<span class="token punctuation">,</span> control_flow<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> event <span class="token punctuation">{</span>
        <span class="token class-name">Event</span><span class="token punctuation">::</span><span class="token class-name">WindowEvent</span> <span class="token punctuation">{</span>
            <span class="token keyword">ref</span> event<span class="token punctuation">,</span>
            window_id<span class="token punctuation">,</span>
        <span class="token punctuation">}</span> <span class="token keyword">if</span> window_id <span class="token operator">==</span> window<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">if</span> <span class="token operator">!</span>state<span class="token punctuation">.</span><span class="token function">input</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// UPDATED!</span>
            <span class="token keyword">match</span> event <span class="token punctuation">{</span>
                <span class="token class-name">WindowEvent</span><span class="token punctuation">::</span><span class="token class-name">CloseRequested</span>
                <span class="token operator">|</span> <span class="token class-name">WindowEvent</span><span class="token punctuation">::</span><span class="token class-name">KeyboardInput</span> <span class="token punctuation">{</span>
                    input<span class="token punctuation">:</span>
                        <span class="token class-name">KeyboardInput</span> <span class="token punctuation">{</span>
                            state<span class="token punctuation">:</span> <span class="token class-name">ElementState</span><span class="token punctuation">::</span><span class="token class-name">Pressed</span><span class="token punctuation">,</span>
                            virtual_keycode<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token class-name">VirtualKeyCode</span><span class="token punctuation">::</span><span class="token class-name">Escape</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                            <span class="token punctuation">..</span>
                        <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">..</span>
                <span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token operator">*</span>control_flow <span class="token operator">=</span> <span class="token class-name">ControlFlow</span><span class="token punctuation">::</span><span class="token class-name">Exit</span><span class="token punctuation">,</span>
                <span class="token class-name">WindowEvent</span><span class="token punctuation">::</span><span class="token class-name">Resized</span><span class="token punctuation">(</span>physical_size<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    state<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token operator">*</span>physical_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token class-name">WindowEvent</span><span class="token punctuation">::</span><span class="token class-name">ScaleFactorChanged</span> <span class="token punctuation">{</span> new_inner_size<span class="token punctuation">,</span> <span class="token punctuation">..</span> <span class="token punctuation">}</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    state<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token operator">*</span>new_inner_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                _ <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        _ <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="update"><a href="#update" class="header-anchor">#</a> update()</h2> <p>æˆ‘ä»¬è¿˜æ²¡æœ‰ä¸œè¥¿éœ€è¦æ›´æ–°ï¼Œæ‰€ä»¥åœ¨æ­¤ç•™ç©ºå³å¯ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">update</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// remove `todo!()`</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åˆ°åç»­éœ€è¦åœ¨å„ç§å¯¹è±¡ä¹‹é—´è·³è½¬æ—¶ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿™é‡Œæ·»åŠ ä¸€äº›ä»£ç ã€‚</p> <h2 id="render"><a href="#render" class="header-anchor">#</a> render()</h2> <p>è¿™é‡Œå°±æ˜¯å¥‡è¿¹å‘ç”Ÿçš„åœ°æ–¹äº†ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦è·å¾—ä¸€å¸§ä»¥ä¾›æ¸²æŸ“ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// impl State</span>

<span class="token keyword">fn</span> <span class="token function-definition function">render</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">SurfaceError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> output <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>surface<span class="token punctuation">.</span><span class="token function">get_current_texture</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
</code></pre></div><p><code>get_current_texture</code> å‡½æ•°ä¼šç­‰å¾… <code>surface</code> æä¾›ä¸€ä¸ªæ–°çš„ <code>SurfaceTexture</code> ä»¥ç”¨äºæ¸²æŸ“ã€‚æˆ‘ä»¬å°†æŠŠå®ƒå‚¨å­˜åœ¨ <code>output</code> ä¸­ä»¥ä¾¿åç»­ä½¿ç”¨ã€‚</p> <div class="language-rust extra-class"><pre class="language-rust"><code>    <span class="token keyword">let</span> view <span class="token operator">=</span> output<span class="token punctuation">.</span>texture<span class="token punctuation">.</span><span class="token function">create_view</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureViewDescriptor</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è¿™ä¸€è¡Œåˆ›å»ºäº†ä¸€ä¸ªä½¿ç”¨é»˜è®¤é…ç½®çš„ <code>TextureView</code>ï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†æ§åˆ¶æ¸²æŸ“ä»£ç ä¸çº¹ç†ä¹‹é—´çš„äº¤äº’ã€‚</p> <p>æˆ‘ä»¬è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ª <code>CommandEncoder</code> æ¥åˆ›å»ºå®é™…å‘é€åˆ° GPU ä¸Šçš„å‘½ä»¤ã€‚å¤§å¤šæ•°ç°ä»£å›¾å½¢æ¡†æ¶ä¼šå°†å‘é€åˆ° GPU ä¹‹å‰çš„å‘½ä»¤å­˜å‚¨åœ¨ä¸€ä¸ªå‘½ä»¤ç¼“å†²åŒºä¹‹ä¸­ã€‚<code>encoder</code> å°±å»ºç«‹äº†ä¸€ä¸ªè¿™æ ·çš„å‘½ä»¤ç¼“å†²åŒºï¼Œå…¶ä¸­çš„æ•°æ®å¯ä»¥å‘é€ç»™ GPUã€‚</p> <div class="language-rust extra-class"><pre class="language-rust"><code>    <span class="token keyword">let</span> <span class="token keyword">mut</span> encoder <span class="token operator">=</span> <span class="token keyword">self</span><span class="token punctuation">.</span>device<span class="token punctuation">.</span><span class="token function">create_command_encoder</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">CommandEncoderDescriptor</span> <span class="token punctuation">{</span>
        label<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">&quot;Render Encoder&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥çœŸæ­£å¼€å§‹æ‰§è¡ŒæœŸç›¼å·²ä¹…çš„æ¸…å±æ“ä½œäº†ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>encoder</code> æ¥åˆ›å»º <code>RenderPass</code>ã€‚è¿™ä¸ª <code>RenderPass</code> æ‹¥æœ‰æ‰€æœ‰ä¾›å®é™…ç»˜å›¾çš„æ–¹æ³•ã€‚ç”±äºåˆ›å»º <code>RenderPass</code> çš„ä»£ç åµŒå¥—è¾ƒæ·±ï¼Œæ‰€ä»¥åœ¨è®¨è®ºå…¶ä¸­ç»†èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæŠŠå®ƒå®Œæ•´åœ°å¤åˆ¶åˆ°è¿™é‡Œï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>    <span class="token punctuation">{</span>
        <span class="token keyword">let</span> _render_pass <span class="token operator">=</span> encoder<span class="token punctuation">.</span><span class="token function">begin_render_pass</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">RenderPassDescriptor</span> <span class="token punctuation">{</span>
            label<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">&quot;Render Pass&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            color_attachments<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">RenderPassColorAttachment</span> <span class="token punctuation">{</span>
                view<span class="token punctuation">:</span> <span class="token operator">&amp;</span>view<span class="token punctuation">,</span>
                resolve_target<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
                ops<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Operations</span> <span class="token punctuation">{</span>
                    load<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">LoadOp</span><span class="token punctuation">::</span><span class="token class-name">Clear</span><span class="token punctuation">(</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Color</span> <span class="token punctuation">{</span>
                        r<span class="token punctuation">:</span> <span class="token number">0.1</span><span class="token punctuation">,</span>
                        g<span class="token punctuation">:</span> <span class="token number">0.2</span><span class="token punctuation">,</span>
                        b<span class="token punctuation">:</span> <span class="token number">0.3</span><span class="token punctuation">,</span>
                        a<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    store<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            depth_stencil_attachment<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// submit æ–¹æ³•èƒ½ä¼ å…¥ä»»ä½•å®ç°äº† IntoIter çš„å‚æ•°</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>queue<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token namespace">std<span class="token punctuation">::</span>iter<span class="token punctuation">::</span></span><span class="token function">once</span><span class="token punctuation">(</span>encoder<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    output<span class="token punctuation">.</span><span class="token function">present</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>é¦–å…ˆè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ <code>encoder.begin_render_pass(...)</code> å¤–éƒ¨é¢å¤–çš„å—ï¼ˆ<code>{}</code>ï¼‰ã€‚ç”±äº <code>begin_render_pass()</code> æ˜¯ä»¥å¯å˜æ–¹å¼å€Ÿç”¨äº† <code>encoder</code>ï¼ˆåˆç§° <code>&amp;mut self</code>ï¼‰ï¼Œå› æ­¤åœ¨æˆ‘ä»¬é‡Šæ”¾è¿™ä¸ªå¯å˜çš„å€Ÿç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬éƒ½ä¸èƒ½è°ƒç”¨ <code>encoder.finish()</code>ã€‚è¿™ä¸ªå—å‘Šè¯‰ rust å½“ä»£ç ç¦»å¼€å…¶ä½œç”¨åŸŸæ—¶ï¼Œé‡Šæ”¾å…¶ä¸­çš„å…¨éƒ¨å˜é‡ï¼Œä»è€Œé‡Šæ”¾ <code>encoder</code> ä¸Šçš„å¯å˜å€Ÿç”¨ï¼Œä»è€Œä½¿å¾—æˆ‘ä»¬èƒ½ <code>finish()</code> å®ƒã€‚å¦‚æœä½ ä¸å–œæ¬¢ <code>{}</code>ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>drop(render_pass)</code> æ¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚</p> <p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡åˆ é™¤ <code>{}</code> å’Œ <code>let _render_pass =</code> è¿™ä¸€è¡Œæ¥è·å¾—åŒæ ·çš„æ•ˆæœï¼Œä½†æˆ‘ä»¬åœ¨ä¸‹ä¸€ä»½æ•™ç¨‹ä¸­éœ€è¦è®¿é—® <code>_render_pass</code>ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œä¿æŒè¿™ä¸ªå†™æ³•å°±å¯ä»¥äº†ã€‚</p> <p>ç¤ºä¾‹ä»£ç ä¸­çš„æœ€åå‡ è¡Œå‘Šè¯‰ wgpu ç»“æŸå¯¹å‘½ä»¤ç¼“å†²åŒºçš„ç¼–ç ï¼Œå¹¶å°†å…¶æäº¤ç»™ GPU çš„æ¸²æŸ“é˜Ÿåˆ—ã€‚</p> <p>æˆ‘ä»¬éœ€è¦å†æ¬¡æ›´æ–°äº‹ä»¶å¾ªç¯æ¥è°ƒç”¨ <code>render</code> æ–¹æ³•ï¼Œæ³¨æ„åœ¨å…¶ä¹‹å‰åº”è¯¥å…ˆè°ƒç”¨ <code>update</code>ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// main()</span>
event_loop<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token keyword">move</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>event<span class="token punctuation">,</span> _<span class="token punctuation">,</span> control_flow<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">match</span> event <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
        <span class="token class-name">Event</span><span class="token punctuation">::</span><span class="token class-name">RedrawRequested</span><span class="token punctuation">(</span>window_id<span class="token punctuation">)</span> <span class="token keyword">if</span> window_id <span class="token operator">==</span> window<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            state<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">match</span> state<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Ok</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
                <span class="token comment">// å¦‚æœå‘ç”Ÿä¸Šä¸‹æ–‡ä¸¢å¤±ï¼Œå°±é‡æ–°é…ç½® surface</span>
                <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">SurfaceError</span><span class="token punctuation">::</span><span class="token class-name">Lost</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token comment">// ç³»ç»Ÿå†…å­˜ä¸è¶³ï¼Œæ­¤æ—¶åº”è¯¥é€€å‡º</span>
                <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">SurfaceError</span><span class="token punctuation">::</span><span class="token class-name">OutOfMemory</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">*</span>control_flow <span class="token operator">=</span> <span class="token class-name">ControlFlow</span><span class="token punctuation">::</span><span class="token class-name">Exit</span><span class="token punctuation">,</span>
                <span class="token comment">// æ‰€æœ‰å…¶ä»–é”™è¯¯ï¼ˆå¦‚è¿‡æ—¶ã€è¶…æ—¶ç­‰ï¼‰éƒ½åº”åœ¨ä¸‹ä¸€å¸§è§£å†³</span>
                <span class="token class-name">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">eprintln!</span><span class="token punctuation">(</span><span class="token string">&quot;{:?}&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Event</span><span class="token punctuation">::</span><span class="token class-name">MainEventsCleared</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// é™¤éæ‰‹åŠ¨è¯·æ±‚ï¼Œå¦åˆ™ RedrawRequested åªä¼šè§¦å‘ä¸€æ¬¡</span>
            window<span class="token punctuation">.</span><span class="token function">request_redraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>åŸºäºä»¥ä¸Šä»£ç ï¼Œä½ åº”è¯¥èƒ½è·å¾—ç±»ä¼¼è¿™æ ·çš„æ•ˆæœï¼š</p> <p><img src="data:image/png;base64,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IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAOiECAADUCREAAKBOiAAAAHVCBAAAqBMiAABAnRABAADqhAgAAFAnRAAAgDohAgAA1AkRAACgTogAAAB1QgQAAKgTIgAAQJ0QAQAA6oQIAABQJ0QAAIA6IQIAANQJEQAAoE6IAAAAdUIEAACoEyIAAECdEAEAAOqECAAAUCdEAACAuqkk2b5udKHnAAAAfob8P4Fe1tYvSjndAAAAAElFTkSuQmCC" alt="å¸¦è“è‰²èƒŒæ™¯çš„çª—å£"></p> <h2 id="å…³äº-renderpassdescriptor"><a href="#å…³äº-renderpassdescriptor" class="header-anchor">#</a> å…³äº RenderPassDescriptor</h2> <p>ä¸€äº›è¯»è€…å¯èƒ½å…‰çœ‹ä¸€éä»£ç å°±èƒ½çŸ¥é“ RenderPassDescriptor èƒŒåçš„ç»†èŠ‚ï¼Œä½†å¦‚æœç¬”è€…ä¸æŠŠå®ƒä»‹ç»ä¸€éï¼Œé‚£å°±æœ‰äº›å¤±èŒäº†ã€‚è®©æˆ‘ä»¬å†çœ‹ä¸€ä¸‹ä»£ç ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">RenderPassDescriptor</span> <span class="token punctuation">{</span>
    label<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">&quot;Render Pass&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    color_attachments<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    depth_stencil_attachment<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸€ä¸ª <code>RenderPassDescriptor</code> åªå¸¦æœ‰ä¸‰ä¸ªå­—æ®µï¼š<code>label</code>ã€<code>color_attachments</code> å’Œ <code>depth_stencil_attachment</code>ã€‚å…¶ä¸­ <code>color_attachments</code> å®šä¹‰äº†é¢œè‰²æ‰€åº”ç»˜åˆ¶åˆ°çš„ç›®æ ‡ã€‚æ­¤å¤„æˆ‘ä»¬ä¼ å…¥ä¹‹å‰åˆ›å»ºçš„ <code>TextureView</code> æ¥ç¡®ä¿æ¸²æŸ“åˆ°å±å¹•ä¸Šã€‚</p> <p>æˆ‘ä»¬åé¢ä¼šç”¨åˆ° <code>depth_stencil_attachment</code>ï¼Œä½†ç°åœ¨å°†å…¶è®¾ç½®ä¸º <code>None</code> å³å¯ã€‚</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">RenderPassColorAttachment</span> <span class="token punctuation">{</span>
    view<span class="token punctuation">:</span> <span class="token operator">&amp;</span>view<span class="token punctuation">,</span>
    resolve_target<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
    ops<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Operations</span> <span class="token punctuation">{</span>
        load<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">LoadOp</span><span class="token punctuation">::</span><span class="token class-name">Clear</span><span class="token punctuation">(</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Color</span> <span class="token punctuation">{</span>
            r<span class="token punctuation">:</span> <span class="token number">0.1</span><span class="token punctuation">,</span>
            g<span class="token punctuation">:</span> <span class="token number">0.2</span><span class="token punctuation">,</span>
            b<span class="token punctuation">:</span> <span class="token number">0.3</span><span class="token punctuation">,</span>
            a<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        store<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>RenderPassColorAttachment</code> æœ‰ä¸€ä¸ª <code>view</code> å­—æ®µï¼Œå®ƒç”¨äºå‘ŠçŸ¥ wgpu åº”å°†é¢œè‰²å­˜å‚¨åˆ°å“ªä¸ªçº¹ç†ã€‚å¯¹ç°åœ¨çš„ä¾‹å­è€Œè¨€ï¼Œè¿™é‡Œåº”å½“ä¼ å…¥æˆ‘ä»¬ç”¨ <code>surface.get_current_texture()</code> æ‰€åˆ›å»ºçš„ <code>view</code>ã€‚è¿™æ„å‘³ç€åç»­åœ¨è¿™ä¸ª attachment ä¸Šæ‰€ç»˜åˆ¶çš„é¢œè‰²éƒ½ä¼šä¸Šå±ã€‚</p> <p><code>resolve_target</code> æ˜¯ç”¨äºæ¥æ”¶å¤šé‡é‡‡æ ·è§£æåæ‰€è¾“å‡ºå†…å®¹çš„çº¹ç†ã€‚é™¤éå¯ç”¨äº†å¤šé‡é‡‡æ ·ï¼Œå¦åˆ™è¿™é‡Œè·å¾—çš„æ•ˆæœåº”å½“ä¸ <code>view</code> ç›¸åŒã€‚æˆ‘ä»¬æ— éœ€è¿›è¡Œè¿™ä¸€é…ç½®ï¼Œæ•…å°†å…¶ä¿ç•™ä¸º <code>None</code> å³å¯ã€‚</p> <p><code>ops</code> å­—æ®µéœ€è¦æ¥æ”¶ä¸€ä¸ª <code>wpgu::Operations</code> å¯¹è±¡ï¼Œå®ƒç”¨äºå‘ŠçŸ¥ wgpu åº”å¦‚ä½•å¤„ç†å±å¹•ä¸Šçš„é¢œè‰²ï¼ˆæ­¤å¤„ç”± <code>view</code> ç¡®å®šï¼‰ã€‚<code>load</code> å­—æ®µå‘Šè¯‰ wgpu è¯¥å¦‚ä½•å¤„ç†å­˜å‚¨åœ¨å‰ä¸€å¸§çš„é¢œè‰²ï¼Œå¯¹åº”åˆ°æˆ‘ä»¬ç›®å‰çš„è®¾å®šï¼Œå³ä¸ºç”¨è“è‰²æ¸…å±ã€‚<code>store</code> å­—æ®µç”¨äºå‘ŠçŸ¥ wgpu æ˜¯å¦åº”å°†æ¸²æŸ“çš„ç»“æœå­˜å‚¨åˆ° <code>TextureView</code> ä¸‹å±‚çš„ <code>Texture</code>ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ <code>SurfaceTexture</code>ï¼‰ã€‚ç”±äºæˆ‘ä»¬ç¡®å®å¸Œæœ›å­˜å‚¨æ¸²æŸ“ç»“æœï¼Œå› æ­¤è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ <code>true</code>ã€‚æœ‰äº›æ—¶å€™æ˜¯ä¸éœ€è¦è¿™ä¹ˆåšçš„ã€‚</p> <div class="note"><p>å¦‚æœå±å¹•ä¼šè¢«ç‰©ä½“å®Œå…¨è¦†ç›–ï¼Œé‚£ä¹ˆä¸æ¸…å±çš„æƒ…å†µä¹Ÿæ˜¯å¾ˆå¸¸è§çš„ã€‚ä½†å¦‚æœä½ çš„åœºæ™¯å¹¶æœªè¦†ç›–æ•´ä¸ªå±å¹•ï¼Œé‚£å°±éœ€è¦ç”¨åˆ°ä¸Šé¢è¿™éƒ¨åˆ†ä»£ç ã€‚</p> <p><img src="/learn-wgpu-cn/assets/img/no-clear.753f913f.png" alt="./no-clear.png"></p></div> <h2 id="å…³äº-validation-error"><a href="#å…³äº-validation-error" class="header-anchor">#</a> å…³äº Validation Error</h2> <p>å¦‚æœ wgpu åœ¨ä½ çš„è®¾å¤‡ä¸Šä½¿ç”¨ Vulkanï¼Œé‚£ä¹ˆå®ƒå¯èƒ½åœ¨æ—§ç‰ˆ Vulkan SDK ä¸Šé‡åˆ° Validation Errorã€‚ä½ åº”è¯¥è‡³å°‘ä½¿ç”¨ <code>1.2.182</code> ç‰ˆæœ¬çš„ SDKï¼Œå› ä¸ºæ—§ç‰ˆå¯èƒ½äº§ç”Ÿä¸€äº›è¯¯æŠ¥ã€‚å¦‚æœé”™è¯¯æŒç»­å­˜åœ¨ï¼Œä¹Ÿå¯èƒ½è¯´æ˜ä½ é‡åˆ°äº† wgpu çš„ bugã€‚ä½ å¯ä»¥åœ¨ <a href="https://github.com/gfx-rs/wgpu" target="_blank" rel="noopener noreferrer">https://github.com/gfx-rs/wgpu<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æäº¤ç›¸åº”çš„ issueã€‚</p> <h2 id="å°æµ‹éªŒ"><a href="#å°æµ‹éªŒ" class="header-anchor">#</a> å°æµ‹éªŒ</h2> <p>ä¿®æ”¹ <code>input()</code> æ–¹æ³•æ¥æ•è·é¼ æ ‡äº‹ä»¶ï¼Œå¹¶ä½¿ç”¨è¯¥æ–¹æ³•æ¥æ›´æ–°æ¸…å±é¢œè‰²ã€‚<em>æç¤ºï¼šä½ å¯èƒ½éœ€è¦ä½¿ç”¨ <code>WindowEvent::CursorMoved</code></em>ã€‚</p> <div class="auto-github-link"><a href="https://github.com/sotrh/learn-wgpu/tree/master/code/beginner/tutorial2-surface/" target="_blank" rel="noopener noreferrer">Check out the code!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">4/24/2022, 10:02:09 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/learn-wgpu-cn/beginner/tutorial1-window/" class="prev">
          ä¾èµ–ä¸çª—å£
        </a></span> <span class="next"><a href="/learn-wgpu-cn/beginner/tutorial3-pipeline/">
          ä½¿ç”¨ Pipeline
        </a>
        â†’
      </span></p></div> </main></div></div><div class="global-ui"><!----></div></div>
    <script src="/learn-wgpu-cn/assets/js/app.4ff5359b.js" defer></script><script src="/learn-wgpu-cn/assets/js/4.7de995c5.js" defer></script><script src="/learn-wgpu-cn/assets/js/14.27582479.js" defer></script><script src="/learn-wgpu-cn/assets/js/25.997fcfd2.js" defer></script>
  </body>
</html>
