<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>çº¹ç†ä¸ BindGroup | å­¦ä¹  Wgpu</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    <meta property="article:modified_time" content="2022-04-30T14:50:47.000Z">
    <meta property="og:site_name" content="å­¦ä¹  Wgpu">
    <meta property="og:title" content="çº¹ç†ä¸ BindGroup">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/beginner/tutorial5-textures/">
    <meta name="twitter:title" content="çº¹ç†ä¸ BindGroup">
    <meta name="twitter:url" content="/beginner/tutorial5-textures/">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Benjamin Hansen">
    <meta name="twitter:creator" content="https://twitter.com/sotrh760">
    
    <link rel="preload" href="/learn-wgpu-cn/assets/css/0.styles.9735b80e.css" as="style"><link rel="preload" href="/learn-wgpu-cn/assets/js/app.4ff5359b.js" as="script"><link rel="preload" href="/learn-wgpu-cn/assets/js/4.7de995c5.js" as="script"><link rel="preload" href="/learn-wgpu-cn/assets/js/8.24d6fd2e.js" as="script"><link rel="preload" href="/learn-wgpu-cn/assets/js/25.997fcfd2.js" as="script"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/1.5a74b06a.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/10.7328fa8a.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/11.7ede3084.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/12.1618c781.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/13.8ed4ca2f.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/14.27582479.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/15.866ab171.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/16.65e20a6a.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/17.13dd0d98.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/18.0b7e17b3.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/19.e99c2c0b.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/2.1ff473f9.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/20.e60a9b69.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/21.640f3b7f.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/22.5e9abdb4.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/23.428ad388.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/24.ddf53bad.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/26.d0cb4a73.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/27.4b3c16d0.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/28.e072a203.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/29.126bb05e.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/30.661cb844.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/31.4d3f435a.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/32.e5012b0b.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/33.336b62e7.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/34.08650f25.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/35.20773e94.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/5.79560850.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/6.4f6de209.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/7.430483e0.js"><link rel="prefetch" href="/learn-wgpu-cn/assets/js/9.0426af3e.js">
    <link rel="stylesheet" href="/learn-wgpu-cn/assets/css/0.styles.9735b80e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="inner"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/learn-wgpu-cn/" class="home-link router-link-active"><!----> <span class="site-name">å­¦ä¹  Wgpu</span></a> <div class="links"><!----> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></div></header> <div class="sidebar-mask"></div> <div class="docs-layout"><aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/learn-wgpu-cn/" aria-current="page" class="sidebar-link">ä»‹ç»</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>å…¥é—¨</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-wgpu-cn/beginner/tutorial1-window/" class="sidebar-link">ä¾èµ–ä¸çª—å£</a></li><li><a href="/learn-wgpu-cn/beginner/tutorial2-surface/" class="sidebar-link">ä½¿ç”¨ Surface</a></li><li><a href="/learn-wgpu-cn/beginner/tutorial3-pipeline/" class="sidebar-link">ä½¿ç”¨ Pipeline</a></li><li><a href="/learn-wgpu-cn/beginner/tutorial4-buffer/" class="sidebar-link">é¡¶ç‚¹ç¼“å†²åŒºä¸ç´¢å¼•ç¼“å†²åŒº</a></li><li><a href="/learn-wgpu-cn/beginner/tutorial5-textures/" aria-current="page" class="active sidebar-link">çº¹ç†ä¸ BindGroup</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial5-textures/#ä»æ–‡ä»¶ä¸­è¯»å–å›¾åƒ" class="sidebar-link">ä»æ–‡ä»¶ä¸­è¯»å–å›¾åƒ</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial5-textures/#å°†æ•°æ®è¯»å–è¿›çº¹ç†" class="sidebar-link">å°†æ•°æ®è¯»å–è¿›çº¹ç†</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial5-textures/#textureview-ä¸-sampler" class="sidebar-link">TextureView ä¸ Sampler</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial5-textures/#ä»‹ç»-bindgroup" class="sidebar-link">ä»‹ç» BindGroup</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial5-textures/#ä»‹ç»-pipelinelayout" class="sidebar-link">ä»‹ç» PipelineLayout</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial5-textures/#å¯¹-vertices-çš„æ”¹åŠ¨" class="sidebar-link">å¯¹ VERTICES çš„æ”¹åŠ¨</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial5-textures/#ç€è‰²å™¨æ—¶é—´" class="sidebar-link">ç€è‰²å™¨æ—¶é—´</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial5-textures/#æ¸²æŸ“ç»“æœ" class="sidebar-link">æ¸²æŸ“ç»“æœ</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial5-textures/#æ•´ç†æ€»ç»“" class="sidebar-link">æ•´ç†æ€»ç»“</a></li><li class="sidebar-sub-header"><a href="/learn-wgpu-cn/beginner/tutorial5-textures/#å°æµ‹éªŒ" class="sidebar-link">å°æµ‹éªŒ</a></li></ul></li><li><a href="/learn-wgpu-cn/beginner/tutorial6-uniforms/" class="sidebar-link">Uniform ç¼“å†²åŒºä¸ 3D ç›¸æœº</a></li><li><a href="/learn-wgpu-cn/beginner/tutorial7-instancing/" class="sidebar-link">å®ä¾‹åŒ–ç»˜åˆ¶</a></li><li><a href="/learn-wgpu-cn/beginner/tutorial8-depth/" class="sidebar-link">æ·±åº¦ç¼“å†²åŒº</a></li><li><a href="/learn-wgpu-cn/beginner/tutorial9-models/" class="sidebar-link">åŠ è½½æ¨¡å‹</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>è¿›é˜¶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/learn-wgpu-cn/intermediate/tutorial10-lighting/" class="sidebar-link">ğŸš§ å¤„ç†å…‰ç…§æ•ˆæœ</a></li><li><a href="/learn-wgpu-cn/intermediate/tutorial11-normals/" class="sidebar-link">ğŸš§ æ³•çº¿è´´å›¾</a></li><li><a href="/learn-wgpu-cn/intermediate/tutorial12-camera/" class="sidebar-link">ğŸš§ æ›´å¥½çš„ç›¸æœº</a></li><li><a href="/learn-wgpu-cn/intermediate/tutorial13-threading/" class="sidebar-link">ğŸš§ åŸºäº Wgpu å’Œ Rayon çš„å¤šçº¿ç¨‹</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ¡ˆä¾‹å±•ç¤º</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>æ›´æ–°åŠ¨æ€</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="çº¹ç†ä¸-bindgroup"><a href="#çº¹ç†ä¸-bindgroup" class="header-anchor">#</a> çº¹ç†ä¸ BindGroup</h1> <p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´éƒ½æ˜¯åœ¨ç»˜åˆ¶éå¸¸ç®€å•çš„å½¢çŠ¶ã€‚è™½ç„¶æˆ‘ä»¬ç¡®å®å¯ä»¥åªç”¨ä¸‰è§’å½¢æ¥åˆ¶ä½œæ¸¸æˆï¼Œä½†å¦‚æœåƒè¿™æ ·ç»˜åˆ¶å¤šè¾¹å½¢ç»†èŠ‚æå¤šçš„ç‰©ä½“ï¼Œä¼šå¤§å¹…å½±å“æ¸¸æˆå¯¹è®¾å¤‡çš„å…¼å®¹æ€§ã€‚æ‰€å¹¸æˆ‘ä»¬å¯ä»¥é€šè¿‡<strong>çº¹ç†</strong>ï¼ˆtextureï¼‰æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p> <p>çº¹ç†æ˜¯å åŠ åœ¨ä¸‰è§’å½¢ç½‘æ ¼ä¸Šçš„å›¾åƒï¼Œä½¿å…¶çœ‹èµ·æ¥èƒ½å…·å¤‡æ›´ä¸°å¯Œçš„ç»†èŠ‚ã€‚çº¹ç†ä¹Ÿå…·æœ‰å¤šç§ç±»å‹ï¼Œå¦‚æ³•çº¿è´´å›¾ã€å‡¹å‡¸è´´å›¾ã€é•œé¢è´´å›¾å’Œæ¼«åå°„è´´å›¾ç­‰ã€‚æ­¤å¤„æˆ‘ä»¬å°†ä»‹ç»æ¼«åå°„è´´å›¾ï¼Œæˆ–è€…è¯´å¾—æ›´ç®€å•ç‚¹ï¼Œé¢œè‰²çº¹ç†ã€‚</p> <h2 id="ä»æ–‡ä»¶ä¸­è¯»å–å›¾åƒ"><a href="#ä»æ–‡ä»¶ä¸­è¯»å–å›¾åƒ" class="header-anchor">#</a> ä»æ–‡ä»¶ä¸­è¯»å–å›¾åƒ</h2> <p>å¦‚æœæƒ³æŠŠå›¾åƒæ˜ å°„åˆ°å¤šè¾¹å½¢ä¸Šï¼Œé‚£è‡³å°‘éœ€è¦å…ˆæœ‰ä¸€å¼ å›¾åƒã€‚è®©æˆ‘ä»¬ä½¿ç”¨è¿™æ£µå¿«ä¹å°æ ‘çš„å›¾ç‰‡å§ï¼š</p> <p><img src="/learn-wgpu-cn/assets/img/happy-tree.bdff8a19.png" alt="a happy tree"></p> <p>æˆ‘ä»¬å°†ä½¿ç”¨ <a href="https://crates.io/crates/image" target="_blank" rel="noopener noreferrer">image crate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¥åŠ è½½è¿™å¼ å›¾ç‰‡ã€‚æˆ‘ä»¬å·²ç»åœ¨ç¬¬ä¸€èŠ‚ä¸­åŠ å…¥äº†å¯¹æ­¤çš„ä¾èµ–ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ä¸ª crateã€‚</p> <p>åœ¨ <code>State</code> çš„ <code>new()</code> æ–¹æ³•ä¸­é…ç½®äº† <code>surface</code> ä¹‹åï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹å³å¯ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>surface<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>device<span class="token punctuation">,</span> <span class="token operator">&amp;</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// NEW!</span>

<span class="token keyword">let</span> diffuse_bytes <span class="token operator">=</span> <span class="token macro property">include_bytes!</span><span class="token punctuation">(</span><span class="token string">&quot;happy-tree.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> diffuse_image <span class="token operator">=</span> <span class="token namespace">image<span class="token punctuation">::</span></span><span class="token function">load_from_memory</span><span class="token punctuation">(</span>diffuse_bytes<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> diffuse_rgba <span class="token operator">=</span> diffuse_image<span class="token punctuation">.</span><span class="token function">as_rgba8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">image<span class="token punctuation">::</span></span><span class="token class-name">GenericImageView</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> dimensions <span class="token operator">=</span> diffuse_image<span class="token punctuation">.</span><span class="token function">dimensions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>è¿™é‡Œæˆ‘ä»¬ä»å›¾åƒæ–‡ä»¶ä¸­è¯»å–äº†å­—èŠ‚æ•°æ®ï¼Œå°†å…¶åŠ è½½åˆ°äº† image å¯¹è±¡ä¸­ï¼Œå¹¶è¿›ä¸€æ­¥å°†å…¶è½¬ä¸ºäº† rgba å­—èŠ‚å½¢å¼çš„ <code>Vec</code>ã€‚æˆ‘ä»¬è¿˜ä¿å­˜äº†å›¾åƒçš„å°ºå¯¸ï¼Œä»¥ä¾¿åœ¨åˆ›å»ºå®é™… <code>Texture</code> æ—¶ä½¿ç”¨ã€‚</p> <p>ç°åœ¨è®©æˆ‘ä»¬æ¥åˆ›å»º <code>Texture</code>ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">let</span> texture_size <span class="token operator">=</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Extent3d</span> <span class="token punctuation">{</span>
    width<span class="token punctuation">:</span> dimensions<span class="token number">.0</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> dimensions<span class="token number">.1</span><span class="token punctuation">,</span>
    depth_or_array_layers<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> diffuse_texture <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">create_texture</span><span class="token punctuation">(</span>
    <span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureDescriptor</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ‰€æœ‰çº¹ç†éƒ½ä¼šä»¥ä¸‰ç»´æ•°ç»„å½¢å¼å­˜å‚¨ï¼Œæˆ‘ä»¬é€šè¿‡è®¾ç½®æ·±åº¦ä¸º 1 æ¥è¡¨ç¤ºè¿™æ˜¯äºŒç»´çš„çº¹ç†</span>
        size<span class="token punctuation">:</span> texture_size<span class="token punctuation">,</span>
        mip_level_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// æˆ‘ä»¬åé¢ä¼šä»‹ç»è¿™é‡Œçš„ç»†èŠ‚</span>
        sample_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        dimension<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureDimension</span><span class="token punctuation">::</span><span class="token constant">D2</span><span class="token punctuation">,</span>
        <span class="token comment">// å¤šæ•°å›¾åƒéƒ½ä½¿ç”¨ sRGB æ ¼å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨æ­¤å°†å…¶ä½“ç°å‡ºæ¥</span>
        format<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureFormat</span><span class="token punctuation">::</span><span class="token class-name">Rgba8UnormSrgb</span><span class="token punctuation">,</span>
        <span class="token comment">// TEXTURE_BINDING å‘Šè¯‰ wgpu æˆ‘ä»¬æƒ³åœ¨ç€è‰²å™¨ä¸­ä½¿ç”¨è¿™ä¸ªçº¹ç†</span>
        <span class="token comment">// COPY_DST åˆ™è¡¨ç¤ºæˆ‘ä»¬æƒ³æŠŠæ•°æ®å¤åˆ¶åˆ°è¿™ä¸ªçº¹ç†</span>
        usage<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureUsages</span><span class="token punctuation">::</span><span class="token constant">TEXTURE_BINDING</span> <span class="token operator">|</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureUsages</span><span class="token punctuation">::</span><span class="token constant">COPY_DST</span><span class="token punctuation">,</span>
        label<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">&quot;diffuse_texture&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="å°†æ•°æ®è¯»å–è¿›çº¹ç†"><a href="#å°†æ•°æ®è¯»å–è¿›çº¹ç†" class="header-anchor">#</a> å°†æ•°æ®è¯»å–è¿›çº¹ç†</h2> <p><code>Texture</code> struct ä¸Šå¹¶æ²¡æœ‰èƒ½ç›´æ¥æ“ä½œå…¶æ•°æ®çš„æ–¹æ³•ã€‚ä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…ˆå‰åˆ›å»ºçš„ <code>queue</code> ä¸Šçš„ <code>write_texture</code> æ–¹æ³•æ¥åŠ è½½çº¹ç†ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™åº”è¯¥å¦‚ä½•å®ç°ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>queue<span class="token punctuation">.</span><span class="token function">write_texture</span><span class="token punctuation">(</span>
    <span class="token comment">// å‘Šè¯‰ wgpu ä»ä½•å¤„å¤åˆ¶åƒç´ æ•°æ®</span>
    <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">ImageCopyTexture</span> <span class="token punctuation">{</span>
        texture<span class="token punctuation">:</span> <span class="token operator">&amp;</span>diffuse_texture<span class="token punctuation">,</span>
        mip_level<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        origin<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Origin3d</span><span class="token punctuation">::</span><span class="token constant">ZERO</span><span class="token punctuation">,</span>
        aspect<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureAspect</span><span class="token punctuation">::</span><span class="token class-name">All</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// å®é™…çš„åƒç´ æ•°æ®</span>
    diffuse_rgba<span class="token punctuation">,</span>
    <span class="token comment">// çº¹ç†çš„å†…å­˜å¸ƒå±€</span>
    <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">ImageDataLayout</span> <span class="token punctuation">{</span>
        offset<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        bytes_per_row<span class="token punctuation">:</span> <span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">NonZeroU32</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> dimensions<span class="token number">.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        rows_per_image<span class="token punctuation">:</span> <span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">NonZeroU32</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>dimensions<span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    texture_size<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="note"><p>å‘çº¹ç†ä¸­å†™å…¥æ•°æ®çš„ç»å…¸æ–¹æ³•æ˜¯å°†åƒç´ æ•°æ®å¤åˆ¶åˆ°ä¸€ä¸ªç¼“å†²åŒºï¼Œç„¶åå†å°†å…¶å¤åˆ¶åˆ°çº¹ç†ä¸­ã€‚ä½¿ç”¨ <code>write_texture</code> åˆ™æ›´ä¸ºé«˜æ•ˆï¼Œå› ä¸ºè¿™æ ·å¯ä»¥å°‘ç”¨ä¸€ä¸ªç¼“å†²åŒºâ€”â€”ä¸è¿‡è¿™é‡Œè¿˜æ˜¯é€‰æ‹©ä»‹ç»è¿™ä¸€å†™æ³•ï¼Œä»¥å¤‡ä¸‡ä¸€ä¹‹ç”¨ã€‚</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">let</span> buffer <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">create_buffer_init</span><span class="token punctuation">(</span>
    <span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span>util<span class="token punctuation">::</span></span><span class="token class-name">BufferInitDescriptor</span> <span class="token punctuation">{</span>
        label<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">&quot;Temp Buffer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        contents<span class="token punctuation">:</span> <span class="token operator">&amp;</span>diffuse_rgba<span class="token punctuation">,</span>
        usage<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BufferUsages</span><span class="token punctuation">::</span><span class="token constant">COPY_SRC</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token keyword">mut</span> encoder <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">create_command_encoder</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">CommandEncoderDescriptor</span> <span class="token punctuation">{</span>
    label<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">&quot;texture_buffer_copy_encoder&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

encoder<span class="token punctuation">.</span><span class="token function">copy_buffer_to_texture</span><span class="token punctuation">(</span>
    <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">ImageCopyBuffer</span> <span class="token punctuation">{</span>
        buffer<span class="token punctuation">:</span> <span class="token operator">&amp;</span>buffer<span class="token punctuation">,</span>
        offset<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        bytes_per_row<span class="token punctuation">:</span> <span class="token number">4</span> <span class="token operator">*</span> dimensions<span class="token number">.0</span><span class="token punctuation">,</span>
        rows_per_image<span class="token punctuation">:</span> dimensions<span class="token number">.1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">ImageCopyTexture</span> <span class="token punctuation">{</span>
        texture<span class="token punctuation">:</span> <span class="token operator">&amp;</span>diffuse_texture<span class="token punctuation">,</span>
        mip_level<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        array_layer<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        origin<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Origin3d</span><span class="token punctuation">::</span><span class="token constant">ZERO</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    size<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

queue<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token namespace">std<span class="token punctuation">::</span>iter<span class="token punctuation">::</span></span><span class="token function">once</span><span class="token punctuation">(</span>encoder<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¸º <code>bytes_per_row</code> å­—æ®µæ‰€èµ‹çš„å€¼éœ€è¦æœ‰ä¸€äº›è€ƒé‡ï¼Œè¿™ä¸ªå€¼éœ€è¦æ˜¯ 256 çš„å€æ•°ã€‚å¯ä»¥æŸ¥é˜… <a href="././showcase/gifs">gif æ•™ç¨‹</a> ä»¥äº†è§£æ›´å¤šç›¸å…³ç»†èŠ‚ã€‚</p></div> <h2 id="textureview-ä¸-sampler"><a href="#textureview-ä¸-sampler" class="header-anchor">#</a> TextureView ä¸ Sampler</h2> <p>ç°åœ¨çº¹ç†ä¸­å·²ç»æœ‰äº†æ•°æ®ï¼Œä¸‹é¢å°±éœ€è¦ä»¥æŸç§æ–¹æ³•æ¥ä½¿ç”¨å®ƒã€‚è¿™å°±è¦ç”¨åˆ° <code>TextureView</code> å’Œ <code>Sampler</code> äº†ã€‚<code>TextureView</code> ç›¸å½“äºå¯¹çº¹ç†æ•°æ®çš„ä¸€ç§<em>è§†å›¾</em>ï¼Œè€Œ <code>Sampler</code> ç”¨äºæ§åˆ¶ <code>Texture</code> å¦‚ä½•è¢«<em>é‡‡æ ·</em>ã€‚é‡‡æ ·è¿‡ç¨‹ç±»ä¼¼äº GIMP æˆ– Photoshop ä¸­çš„æ»´ç®¡å–è‰²å·¥å…·ï¼Œç¨‹åºæ”¯æŒè¯»å…¥ç”¨äºå®šä½çº¹ç†ä¸Šä½ç½®çš„åæ ‡ï¼ˆäº¦å³<em>çº¹ç†åæ ‡</em>ï¼‰ï¼Œç„¶åé‡‡æ ·å™¨å°±ä¼šæ ¹æ®çº¹ç†å†…å®¹å’Œä¸€äº›å†…éƒ¨å‚æ•°æ¥è¿”å›ç›¸åº”ä½ç½®çš„é¢œè‰²ã€‚</p> <p>ç°åœ¨è®©æˆ‘ä»¬æ¥å®šä¹‰ <code>diffuse_texture_view</code> å’Œ <code>diffuse_sampler</code> å§ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// æˆ‘ä»¬æ— éœ€æ‰‹åŠ¨é…ç½®çº¹ç†è§†å›¾ï¼Œè®© wgpu å®šä¹‰å®ƒå³å¯</span>
<span class="token keyword">let</span> diffuse_texture_view <span class="token operator">=</span> diffuse_texture<span class="token punctuation">.</span><span class="token function">create_view</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureViewDescriptor</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> diffuse_sampler <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">create_sampler</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">SamplerDescriptor</span> <span class="token punctuation">{</span>
    address_mode_u<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">AddressMode</span><span class="token punctuation">::</span><span class="token class-name">ClampToEdge</span><span class="token punctuation">,</span>
    address_mode_v<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">AddressMode</span><span class="token punctuation">::</span><span class="token class-name">ClampToEdge</span><span class="token punctuation">,</span>
    address_mode_w<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">AddressMode</span><span class="token punctuation">::</span><span class="token class-name">ClampToEdge</span><span class="token punctuation">,</span>
    mag_filter<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">FilterMode</span><span class="token punctuation">::</span><span class="token class-name">Linear</span><span class="token punctuation">,</span>
    min_filter<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">FilterMode</span><span class="token punctuation">::</span><span class="token class-name">Nearest</span><span class="token punctuation">,</span>
    mipmap_filter<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">FilterMode</span><span class="token punctuation">::</span><span class="token class-name">Nearest</span><span class="token punctuation">,</span>
    <span class="token punctuation">..</span><span class="token class-name">Default</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å¦‚æœé‡‡æ ·å™¨æ¥æ”¶åˆ°çš„çº¹ç†åæ ‡åœ¨çº¹ç†æœ¬èº«ä¹‹å¤–ï¼Œé‚£ä¹ˆ <code>address_mode_*</code> å‚æ•°å¯ç”¨äºå†³å®šæ­¤æ—¶çš„å¤„ç†æœºåˆ¶ã€‚è¿™é‡Œæœ‰å‡ ä¸ªé€‰é¡¹å¯ä¾›é€‰æ‹©ï¼š</p> <ul><li><code>ClampToEdge</code>ï¼šå¯¹ä»»ä½•åœ¨çº¹ç†ä¹‹å¤–çš„çº¹ç†åæ ‡ï¼Œéƒ½è¿”å›ç¦»çº¹ç†è¾¹ç¼˜æœ€è¿‘åƒç´ çš„é¢œè‰²ã€‚</li> <li><code>Repeat</code>ï¼šå½“çº¹ç†åæ ‡è¶…è¿‡çº¹ç†å°ºå¯¸æ—¶ï¼Œçº¹ç†å°†é‡å¤ã€‚</li> <li><code>MirrorRepeat</code>ï¼šç±»ä¼¼äº <code>Repeat</code>ï¼Œä½†å›¾åƒåœ¨è¶Šè¿‡è¾¹ç•Œæ—¶å°†ç¿»è½¬ã€‚</li></ul> <p><img src="/learn-wgpu-cn/assets/img/address_mode.66a7cd1a.png" alt="address_mode.png"></p> <p><code>mag_filter</code> å’Œ <code>min_filter</code> é€‰é¡¹æè¿°äº†å½“ä¸€ä¸ªç‰‡å…ƒè¦†ç›–äº†å¤šä¸ªåƒç´ ï¼Œæˆ–ä¸€ä¸ªåƒç´ å†…å­˜åœ¨å¤šä¸ªç‰‡å…ƒæ—¶ï¼Œåº”å½“åšæ€æ ·çš„å¤„ç†ã€‚å½“ä»è¿‘å¤„æˆ–è¿œå¤„è§‚å¯Ÿä¸€ä¸ªå¤šè¾¹å½¢è¡¨é¢æ—¶ï¼Œè¿™ä¸ªé…ç½®ç»å¸¸ä¼šå¸¦æ¥å½±å“ã€‚</p> <p>è¿™é‡Œæœ‰ä¸¤ç§é€‰é¡¹ï¼š</p> <ul><li><code>Linear</code>ï¼šå°è¯•æ··åˆä¸­é—´çš„ç‰‡å…ƒï¼Œä½¿å®ƒä»¬çœ‹èµ·æ¥å¹³æ»‘ã€‚</li> <li><code>Nearest</code>ï¼šä¸­é—´çš„ç‰‡å…ƒå°†ä½¿ç”¨æœ€è¿‘åƒç´ çš„é¢œè‰²ã€‚è¿™æ ·å¯ä»¥è·å¾—ä»è¿œå¤„çœ‹è¾ƒä¸ºé”åˆ©çš„å›¾åƒï¼Œä½†ä»è¿‘å¤„çœ‹æ¥åˆ™ä¼šæœ‰åƒç´ åŒ–çš„æ•ˆæœã€‚ä¸è¿‡å¦‚æœçº¹ç†æœ¬èº«å°±è¢«è®¾è®¡æˆåƒç´ åŒ–å½¢å¼ï¼ˆå¦‚åƒç´ è‰ºæœ¯æ¸¸æˆæˆ–åƒ Minecraft è¿™æ ·çš„ä½“ç´ æ¸¸æˆï¼‰ï¼Œè¿™ä¸ªé…ç½®çš„æ•ˆæœä¹Ÿå¯èƒ½ç¬¦åˆé¢„æœŸã€‚</li></ul> <p>Mipmap æ˜¯ä¸€ä¸ªå¤æ‚çš„è¯é¢˜ï¼Œå°†æ¥åº”å½“æœ‰<a href="/todo">ç‹¬ç«‹çš„ç« èŠ‚</a>ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥ç®€å•è®¤ä¸º <code>mipmap_filter</code> çš„åŠŸèƒ½ç±»ä¼¼äº <code>(mag/min)_filter</code>ï¼Œå®ƒä¼šå‘Šè¯‰é‡‡æ ·å™¨è¯¥å¦‚ä½•åœ¨å„ä¸ªå±‚çº§çš„ mipmap ä¹‹é—´åšæ··åˆã€‚</p> <p>è¿™é‡Œå¯¹å…¶ä»–å­—æ®µä½¿ç”¨äº†ä¸€äº›é»˜è®¤å€¼ã€‚å¦‚æœæƒ³è¯¦ç»†äº†è§£å…¶é…ç½®ï¼Œè¯·æŸ¥çœ‹ <a href="https://docs.rs/wgpu/0.12.0/wgpu/struct.SamplerDescriptor.html" target="_blank" rel="noopener noreferrer">wgpu æ–‡æ¡£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <p>è™½ç„¶è¿™äº›ä¸åŒçš„èµ„æºç±»å‹éƒ½å¾ˆå¼ºå¤§ï¼Œä½†å¦‚æœæ— æ³•å°†å®ƒä»¬æ¥å…¥æ¸²æŸ“ç³»ç»Ÿä¸­ï¼Œé‚£ä¹Ÿæ²¡æœ‰å®é™…çš„ç”¨å¤„ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸€ç‚¹ï¼Œå°±éœ€è¦ä½¿ç”¨ <code>BindGroup</code> å’Œ <code>PipelineLayout</code> äº†ã€‚</p> <h2 id="ä»‹ç»-bindgroup"><a href="#ä»‹ç»-bindgroup" class="header-anchor">#</a> ä»‹ç» BindGroup</h2> <p><code>BindGroup</code> å¯ä»¥æè¿°ä¸€ç»„èµ„æºï¼Œå¹¶ç¡®å®šå®ƒä»¬åº”å½“å¦‚ä½•è¢«ç€è‰²å™¨æ‰€è®¿é—®ã€‚<code>BindGroup</code> å¯ä»¥ç”¨ <code>BindGroupLayout</code> æ¥åˆ›å»ºã€‚è®©æˆ‘ä»¬å…ˆåŠ¨æ‰‹å®ç°ä¸€ä¸ªï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">let</span> texture_bind_group_layout <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">create_bind_group_layout</span><span class="token punctuation">(</span>
    <span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindGroupLayoutDescriptor</span> <span class="token punctuation">{</span>
        entries<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>
            <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindGroupLayoutEntry</span> <span class="token punctuation">{</span>
                binding<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                visibility<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">ShaderStages</span><span class="token punctuation">::</span><span class="token constant">FRAGMENT</span><span class="token punctuation">,</span>
                ty<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindingType</span><span class="token punctuation">::</span><span class="token class-name">Texture</span> <span class="token punctuation">{</span>
                    multisampled<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                    view_dimension<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureViewDimension</span><span class="token punctuation">::</span><span class="token constant">D2</span><span class="token punctuation">,</span>
                    sample_type<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureSampleType</span><span class="token punctuation">::</span><span class="token class-name">Float</span> <span class="token punctuation">{</span> filterable<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                count<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindGroupLayoutEntry</span> <span class="token punctuation">{</span>
                binding<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                visibility<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">ShaderStages</span><span class="token punctuation">::</span><span class="token constant">FRAGMENT</span><span class="token punctuation">,</span>
                ty<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindingType</span><span class="token punctuation">::</span><span class="token class-name">Sampler</span><span class="token punctuation">(</span>
                    <span class="token comment">// SamplerBindingType::Comparison ä»…å¯ä¾› TextureSampleType::Depth ä½¿ç”¨</span>
                    <span class="token comment">// å¦‚æœçº¹ç†çš„ sample_type æ˜¯ TextureSampleType::Float { filterable: true }</span>
                    <span class="token comment">// é‚£ä¹ˆå°±åº”å½“ä½¿ç”¨ SamplerBindingType::Filtering</span>
                    <span class="token comment">// å¦åˆ™ä¼šæŠ¥é”™</span>
                    <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">SamplerBindingType</span><span class="token punctuation">::</span><span class="token class-name">Filtering</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">,</span>
                count<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        label<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">&quot;texture_bind_group_layout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>texture_bind_group_layout</code> æœ‰ä¸¤ä¸ªå…¥å£ï¼šä¸€ä¸ªæ˜¯ç»‘å®šåˆ° 0 çš„è¢«é‡‡æ ·çº¹ç†ï¼Œå¦ä¸€ä¸ªæ˜¯ç»‘å®šåˆ° 1 çš„é‡‡æ ·å™¨ã€‚è¿™ä¸¤ä¸ªç»‘å®šåªå¯¹ç”± <code>FRAGMENT</code> å¸¸é‡æ‰€æŒ‡å®šçš„ç‰‡å…ƒç€è‰²å™¨å¯è§ã€‚è¿™ä¸ªå­—æ®µçš„å¯é€‰å€¼æ˜¯ <code>NONE</code>ã€<code>VERTEX</code>ã€<code>FRAGMENT</code> æˆ– <code>COMPUTE</code> çš„ä»»æ„ä½æ•°ç»„åˆã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªä¼šå¯¹çº¹ç†å’Œé‡‡æ ·å™¨ä½¿ç”¨ <code>FRAGMENT</code> é…ç½®ï¼Œä½†å…¶ä»–çš„å¯é€‰é¡¹ä¹Ÿå€¼å¾—äº†è§£ã€‚</p> <p>æœ‰äº† <code>texture_bind_group_layout</code> ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»º <code>BindGroup</code> äº†ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">let</span> diffuse_bind_group <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">create_bind_group</span><span class="token punctuation">(</span>
    <span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindGroupDescriptor</span> <span class="token punctuation">{</span>
        layout<span class="token punctuation">:</span> <span class="token operator">&amp;</span>texture_bind_group_layout<span class="token punctuation">,</span>
        entries<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>
            <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindGroupEntry</span> <span class="token punctuation">{</span>
                binding<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                resource<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindingResource</span><span class="token punctuation">::</span><span class="token class-name">TextureView</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>diffuse_texture_view<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindGroupEntry</span> <span class="token punctuation">{</span>
                binding<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                resource<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindingResource</span><span class="token punctuation">::</span><span class="token class-name">Sampler</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>diffuse_sampler<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        label<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">&quot;diffuse_bind_group&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¸Šé¢çš„ä»£ç å¯èƒ½ä¼šè®©ä½ äº§ç”Ÿä¸€ç‚¹æ—¢è§†æ„Ÿï¼è¿™æ˜¯å› ä¸º <code>BindGroup</code> æ˜¯ <code>BindGroupLayout</code> çš„ä¸€ä»½æ›´ä¸ºå…·ä½“çš„å£°æ˜ã€‚å°†å®ƒä»¬åˆ†ç¦»çš„åŸå› æ˜¯è¿™æ ·å…è®¸æˆ‘ä»¬åœ¨è¿è¡Œæ—¶åŠ¨æ€äº¤æ¢ä¸åŒçš„ <code>BindGroup</code>ï¼Œåªè¦å®ƒä»¬éƒ½å…±äº«åŒä¸€ä¸ª <code>BindGroupLayout</code> å³å¯ã€‚æˆ‘ä»¬åˆ›å»ºçš„æ¯ä¸ªçº¹ç†å’Œé‡‡æ ·å™¨éƒ½éœ€è¦æ·»åŠ åˆ°æŸä¸ª <code>BindGroup</code> ä¸­ã€‚æ­¤å¤„æˆ‘ä»¬å°†ä¸ºæ¯ä¸ªçº¹ç†åˆ›å»ºä¸€ä¸ªæ–°çš„ bind groupã€‚</p> <p>ç°åœ¨æˆ‘ä»¬æœ‰äº† <code>diffuse_bind_group</code>ï¼Œå¯ä»¥å°†å…¶æ·»åŠ åˆ° <code>State</code> struct ä¸­ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">struct</span> <span class="token type-definition class-name">State</span> <span class="token punctuation">{</span>
    surface<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Surface</span><span class="token punctuation">,</span>
    device<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Device</span><span class="token punctuation">,</span>
    queue<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Queue</span><span class="token punctuation">,</span>
    config<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">SurfaceConfiguration</span><span class="token punctuation">,</span>
    size<span class="token punctuation">:</span> <span class="token namespace">winit<span class="token punctuation">::</span>dpi<span class="token punctuation">::</span></span><span class="token class-name">PhysicalSize</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
    render_pipeline<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">RenderPipeline</span><span class="token punctuation">,</span>
    vertex_buffer<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Buffer</span><span class="token punctuation">,</span>
    index_buffer<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Buffer</span><span class="token punctuation">,</span>
    num_indices<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
    diffuse_bind_group<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindGroup</span><span class="token punctuation">,</span> <span class="token comment">// NEW!</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¯·ç¡®ä¿åœ¨ <code>new</code> æ–¹æ³•ä¸­è¿”å›è¿™äº›å­—æ®µï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">impl</span> <span class="token class-name">State</span> <span class="token punctuation">{</span>
    <span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            surface<span class="token punctuation">,</span>
            device<span class="token punctuation">,</span>
            queue<span class="token punctuation">,</span>
            config<span class="token punctuation">,</span>
            size<span class="token punctuation">,</span>
            render_pipeline<span class="token punctuation">,</span>
            vertex_buffer<span class="token punctuation">,</span>
            index_buffer<span class="token punctuation">,</span>
            num_indices<span class="token punctuation">,</span>
            <span class="token comment">// NEW!</span>
            diffuse_bind_group<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç°åœ¨æˆ‘ä»¬å·²ç»è·å¾—äº† <code>BindGroup</code>ï¼Œå¯ä»¥åœ¨ <code>render()</code> å‡½æ•°ä¸­ä½¿ç”¨å®ƒäº†ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// render()</span>
<span class="token comment">// ...</span>
render_pass<span class="token punctuation">.</span><span class="token function">set_pipeline</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>render_pipeline<span class="token punctuation">)</span><span class="token punctuation">;</span>
render_pass<span class="token punctuation">.</span><span class="token function">set_bind_group</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">.</span>diffuse_bind_group<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// NEW!</span>
render_pass<span class="token punctuation">.</span><span class="token function">set_vertex_buffer</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>vertex_buffer<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">..</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
render_pass<span class="token punctuation">.</span><span class="token function">set_index_buffer</span><span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">.</span>index_buffer<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">..</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">IndexFormat</span><span class="token punctuation">::</span><span class="token class-name">Uint16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

render_pass<span class="token punctuation">.</span><span class="token function">draw_indexed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token keyword">self</span><span class="token punctuation">.</span>num_indices<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="ä»‹ç»-pipelinelayout"><a href="#ä»‹ç»-pipelinelayout" class="header-anchor">#</a> ä»‹ç» PipelineLayout</h2> <p>è¿˜è®°å¾—æˆ‘ä»¬åœ¨ <a href="/beginner/tutorial3-pipeline#how-do-we-use-the-shaders">pipeline ç« èŠ‚</a>ä¸­åˆ›å»ºçš„ <code>PipelineLayout</code> å—ï¼Ÿç°åœ¨æˆ‘ä»¬ç»ˆäºè¦ç”¨åˆ°å®ƒäº†ï¼<code>PipelineLayout</code> åŒ…å«ä¸€ä»½å¯ä¾›ç®¡çº¿ä½¿ç”¨çš„ <code>BindGroupLayout</code> åˆ—è¡¨ã€‚ä¿®æ”¹ <code>render_pipeline_layout</code> åå³å¯ä½¿ç”¨æˆ‘ä»¬çš„ <code>texture_bind_group_layout</code>ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">...</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">let</span> render_pipeline_layout <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">create_pipeline_layout</span><span class="token punctuation">(</span>
        <span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">PipelineLayoutDescriptor</span> <span class="token punctuation">{</span>
            label<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">&quot;Render Pipeline Layout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            bind_group_layouts<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token operator">&amp;</span>texture_bind_group_layout<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// NEW!</span>
            push_constant_ranges<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="å¯¹-vertices-çš„æ”¹åŠ¨"><a href="#å¯¹-vertices-çš„æ”¹åŠ¨" class="header-anchor">#</a> å¯¹ VERTICES çš„æ”¹åŠ¨</h2> <p>ç°åœ¨æˆ‘ä»¬éœ€è¦å¯¹ <code>Vertex</code> çš„å®šä¹‰åšä¸€äº›æ”¹åŠ¨ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´æ˜¯åœ¨ä½¿ç”¨ <code>color</code> å±æ€§æ¥è®¾ç½®æˆ‘ä»¬æ‰€ç»˜åˆ¶å½¢ä½“çš„é¢œè‰²ã€‚ç°åœ¨æˆ‘ä»¬ä½¿ç”¨äº†çº¹ç†ï¼Œå› æ­¤å¯ä»¥ç”¨è®°å½•çº¹ç†åæ ‡çš„ <code>tex_coords</code> æ¥ä»£æ›¿ <code>color</code>ï¼Œè¿™äº›åæ ‡å°†è¢«ä¼ é€’ç»™ <code>Sampler</code> ä»¥è·å–é€‚å½“çš„é¢œè‰²ã€‚</p> <p>ç”±äºæˆ‘ä»¬çš„ <code>tex_coords</code> æ˜¯äºŒç»´çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªå­—æ®µæ”¹ä¸ºä½¿ç”¨ä¸¤ä¸ªæµ®ç‚¹æ•°ï¼Œè€ŒéåŸå…ˆçš„ä¸‰ä¸ªã€‚</p> <p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ”¹å˜ <code>Vertex</code> structï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token attribute attr-name">#[repr(C)]</span>
<span class="token attribute attr-name">#[derive(Copy, Clone, Debug, bytemuck::Pod, bytemuck::Zeroable)]</span>
<span class="token keyword">struct</span> <span class="token type-definition class-name">Vertex</span> <span class="token punctuation">{</span>
    position<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token keyword">f32</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    tex_coords<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token keyword">f32</span><span class="token punctuation">;</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// NEW!</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç„¶ååœ¨ <code>VertexBufferLayout</code> ä¸­åæ˜ è¿™äº›å˜åŒ–ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">impl</span> <span class="token class-name">Vertex</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">desc</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">VertexBufferLayout</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>mem<span class="token punctuation">;</span>
        <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">VertexBufferLayout</span> <span class="token punctuation">{</span>
            array_stride<span class="token punctuation">:</span> <span class="token namespace">mem<span class="token punctuation">::</span></span><span class="token function">size_of</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Vertex</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BufferAddress</span><span class="token punctuation">,</span>
            step_mode<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">VertexStepMode</span><span class="token punctuation">::</span><span class="token class-name">Vertex</span><span class="token punctuation">,</span>
            attributes<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>
                <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">VertexAttribute</span> <span class="token punctuation">{</span>
                    offset<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                    shader_location<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                    format<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">VertexFormat</span><span class="token punctuation">::</span><span class="token class-name">Float32x3</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">VertexAttribute</span> <span class="token punctuation">{</span>
                    offset<span class="token punctuation">:</span> <span class="token namespace">mem<span class="token punctuation">::</span></span><span class="token function">size_of</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token punctuation">[</span><span class="token keyword">f32</span><span class="token punctuation">;</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BufferAddress</span><span class="token punctuation">,</span>
                    shader_location<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                    format<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">VertexFormat</span><span class="token punctuation">::</span><span class="token class-name">Float32x2</span><span class="token punctuation">,</span> <span class="token comment">// NEW!</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æœ€åæˆ‘ä»¬éœ€è¦æ”¹å˜ <code>VERTICES</code> çš„å†…å®¹ï¼Œç”¨ä»¥ä¸‹æ•°æ®å–ä»£ç°æœ‰çš„å®šä¹‰ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// Changed</span>
<span class="token keyword">const</span> <span class="token constant">VERTICES</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token class-name">Vertex</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>
    <span class="token class-name">Vertex</span> <span class="token punctuation">{</span> position<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.0868241</span><span class="token punctuation">,</span> <span class="token number">0.49240386</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tex_coords<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.4131759</span><span class="token punctuation">,</span> <span class="token number">0.99240386</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// A</span>
    <span class="token class-name">Vertex</span> <span class="token punctuation">{</span> position<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.49513406</span><span class="token punctuation">,</span> <span class="token number">0.06958647</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tex_coords<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.0048659444</span><span class="token punctuation">,</span> <span class="token number">0.56958647</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// B</span>
    <span class="token class-name">Vertex</span> <span class="token punctuation">{</span> position<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.21918549</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.44939706</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tex_coords<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.28081453</span><span class="token punctuation">,</span> <span class="token number">0.05060294</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// C</span>
    <span class="token class-name">Vertex</span> <span class="token punctuation">{</span> position<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.35966998</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.3473291</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tex_coords<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.85967</span><span class="token punctuation">,</span> <span class="token number">0.1526709</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// D</span>
    <span class="token class-name">Vertex</span> <span class="token punctuation">{</span> position<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.44147372</span><span class="token punctuation">,</span> <span class="token number">0.2347359</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tex_coords<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.9414737</span><span class="token punctuation">,</span> <span class="token number">0.7347359</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// E</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="ç€è‰²å™¨æ—¶é—´"><a href="#ç€è‰²å™¨æ—¶é—´" class="header-anchor">#</a> ç€è‰²å™¨æ—¶é—´</h2> <p>æœ‰äº†æ–°çš„ <code>Vertex</code> ç»“æ„åï¼Œå°±è¯¥ä¿®æ”¹ç€è‰²å™¨äº†ã€‚æˆ‘ä»¬é¦–å…ˆéœ€è¦å°† <code>tex_coords</code> ä¼ é€’ç»™é¡¶ç‚¹ç€è‰²å™¨ï¼Œç„¶åå†å°†å®ƒä»¬ç”¨äºç‰‡å…ƒç€è‰²å™¨ï¼Œä»¥ä¾¿ä» <code>Sampler</code> ä¸­è·å¾—æœ€ç»ˆçš„é¢œè‰²ã€‚è®©æˆ‘ä»¬ä»é¡¶ç‚¹ç€è‰²å™¨å¼€å§‹ï¼š</p> <div class="language-wgsl extra-class"><pre class="language-text"><code>// é¡¶ç‚¹ç€è‰²å™¨

struct VertexInput {
    [[location(0)]] position: vec3&lt;f32&gt;;
    [[location(1)]] tex_coords: vec2&lt;f32&gt;;
};

struct VertexOutput {
    [[builtin(position)]] clip_position: vec4&lt;f32&gt;;
    [[location(0)]] tex_coords: vec2&lt;f32&gt;;
};

[[stage(vertex)]]
fn vs_main(
    model: VertexInput,
) -&gt; VertexOutput {
    var out: VertexOutput;
    out.tex_coords = model.tex_coords;
    out.clip_position = vec4&lt;f32&gt;(model.position, 1.0);
    return out;
}
</code></pre></div><p>ç°åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¼šè¾“å‡º <code>tex_coords</code>ï¼Œæˆ‘ä»¬éœ€è¦æ”¹å˜ç‰‡å…ƒç€è‰²å™¨æ¥æ¥æ”¶å®ƒä»¬ã€‚æœ‰äº†è¿™äº›åæ ‡ï¼Œæˆ‘ä»¬å°±ç»ˆäºå¯ä»¥ç”¨é‡‡æ ·å™¨ä»çº¹ç†ä¸­è·å–é¢œè‰²äº†ï¼š</p> <div class="language-wgsl extra-class"><pre class="language-text"><code>// ç‰‡å…ƒç€è‰²å™¨

[[group(0), binding(0)]]
var t_diffuse: texture_2d&lt;f32&gt;;
[[group(0), binding(1)]]
var s_diffuse: sampler;

[[stage(fragment)]]
fn fs_main(in: VertexOutput) -&gt; [[location(0)]] vec4&lt;f32&gt; {
    return textureSample(t_diffuse, s_diffuse, in.tex_coords);
}
</code></pre></div><p>è¿™é‡Œçš„å˜é‡ <code>t_diffuse</code> å’Œ <code>s_diffuse</code> å°±æ˜¯æ‰€è°“çš„ uniformã€‚æˆ‘ä»¬å°†åœ¨<a href="/learn-wgpu-cn/beginner/tutorial6-uniforms/">ç›¸æœºéƒ¨åˆ†</a>ä¸­è¿›ä¸€æ­¥è®¨è®ºå®ƒä»¬ã€‚ç°åœ¨æˆ‘ä»¬æ‰€éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œ<code>group()</code> å¯¹åº”äº <code>set_bind_group()</code> ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ<code>binding()</code> åˆ™ä¸æˆ‘ä»¬åˆ›å»º <code>BindGroupLayout</code> å’Œ <code>BindGroup</code> æ—¶æ‰€æŒ‡å®šçš„ <code>binding</code> æœ‰å…³ã€‚</p> <h2 id="æ¸²æŸ“ç»“æœ"><a href="#æ¸²æŸ“ç»“æœ" class="header-anchor">#</a> æ¸²æŸ“ç»“æœ</h2> <p>å¦‚æœç°åœ¨è¿è¡Œæˆ‘ä»¬çš„ç¨‹åºï¼Œåº”è¯¥å¾—åˆ°ä»¥ä¸‹ç»“æœï¼š</p> <p><img src="/learn-wgpu-cn/assets/img/upside-down.d50c3643.png" alt="an upside down tree on a hexagon"></p> <p>è¿™å¾ˆå¥‡æ€ªï¼Œæˆ‘ä»¬çš„æ ‘ä¸Šä¸‹é¢ å€’äº†ï¼è¿™æ˜¯å› ä¸º wgpu ä¸­ä¸–ç•Œåæ ‡ç³»çš„ Y è½´æŒ‡å‘ä¸Šæ–¹ï¼Œè€Œçº¹ç†åæ ‡ç³»çš„ Y è½´æŒ‡å‘ä¸‹æ–¹ã€‚æ¢å¥è¯è¯´ï¼Œçº¹ç†åæ ‡ä¸­çš„ <code>(0, 0)</code> å¯¹åº”å›¾åƒçš„å·¦ä¸Šè§’ï¼Œè€Œ <code>(1,1)</code> å¯¹åº”å³ä¸‹è§’ã€‚</p> <p><img src="/learn-wgpu-cn/assets/img/happy-tree-uv-coords.aa3b7d36.png" alt="happy-tree-uv-coords.png"></p> <p>æˆ‘ä»¬å¯ä»¥å°†æ¯ä¸ªçº¹ç†åæ ‡çš„ y åæ ‡ <code>y</code> æ›¿æ¢ä¸º <code>1 - y</code>ï¼Œä»¥æ­¤å¾—åˆ°ä¸‰è§’å½¢çš„æ­£ç¡®æœå‘ã€‚</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">const</span> <span class="token constant">VERTICES</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token class-name">Vertex</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>
    <span class="token comment">// Changed</span>
    <span class="token class-name">Vertex</span> <span class="token punctuation">{</span> position<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.0868241</span><span class="token punctuation">,</span> <span class="token number">0.49240386</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tex_coords<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.4131759</span><span class="token punctuation">,</span> <span class="token number">0.00759614</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// A</span>
    <span class="token class-name">Vertex</span> <span class="token punctuation">{</span> position<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.49513406</span><span class="token punctuation">,</span> <span class="token number">0.06958647</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tex_coords<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.0048659444</span><span class="token punctuation">,</span> <span class="token number">0.43041354</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// B</span>
    <span class="token class-name">Vertex</span> <span class="token punctuation">{</span> position<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.21918549</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.44939706</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tex_coords<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.28081453</span><span class="token punctuation">,</span> <span class="token number">0.949397</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// C</span>
    <span class="token class-name">Vertex</span> <span class="token punctuation">{</span> position<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.35966998</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.3473291</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tex_coords<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.85967</span><span class="token punctuation">,</span> <span class="token number">0.84732914</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// D</span>
    <span class="token class-name">Vertex</span> <span class="token punctuation">{</span> position<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.44147372</span><span class="token punctuation">,</span> <span class="token number">0.2347359</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tex_coords<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.9414737</span><span class="token punctuation">,</span> <span class="token number">0.2652641</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// E</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>è¿™æ ·å°±å¯ä»¥æŠŠæ ‘æ­£ç¡®åœ°æ”¾åœ¨äº”è¾¹å½¢ä¸Šäº†ï¼š</p> <p><img src="/learn-wgpu-cn/assets/img/rightside-up.75f852e2.png" alt="our happy tree as it should be"></p> <h2 id="æ•´ç†æ€»ç»“"><a href="#æ•´ç†æ€»ç»“" class="header-anchor">#</a> æ•´ç†æ€»ç»“</h2> <p>ä¸ºæ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬å¸Œæœ›æŠŠçº¹ç†ä»£ç æ•´ç†è¿›å…¶å¯¹åº”çš„æ¨¡å—ã€‚æˆ‘ä»¬é¦–å…ˆéœ€è¦å°† <a href="https://docs.rs/anyhow/" target="_blank" rel="noopener noreferrer">anyhow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> crate æ·»åŠ åˆ° <code>Cargo.toml</code> æ–‡ä»¶ä¸­ï¼Œä»¥ç®€åŒ–é”™è¯¯å¤„ç†ï¼š</p> <div class="language-toml extra-class"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">dependencies</span><span class="token punctuation">]</span>
<span class="token key property">image</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.23&quot;</span>
<span class="token key property">cgmath</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.18&quot;</span>
<span class="token key property">winit</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.26&quot;</span>
<span class="token key property">env_logger</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.9&quot;</span>
<span class="token key property">log</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.4&quot;</span>
<span class="token key property">pollster</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.2&quot;</span>
<span class="token key property">wgpu</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.12&quot;</span>
<span class="token key property">bytemuck</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span> <span class="token key property">version</span> <span class="token punctuation">=</span> <span class="token string">&quot;1.4&quot;</span><span class="token punctuation">,</span> <span class="token key property">features</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span> <span class="token string">&quot;derive&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token key property">anyhow</span> <span class="token punctuation">=</span> <span class="token string">&quot;1.0&quot;</span> <span class="token comment"># NEW!</span>
</code></pre></div><p>ç„¶ååœ¨ä¸€ä¸ªåä¸º <code>src/texture.rs</code> çš„æ–°æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">image<span class="token punctuation">::</span></span><span class="token class-name">GenericImageView</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">anyhow<span class="token punctuation">::</span></span><span class="token operator">*</span><span class="token punctuation">;</span>

<span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Texture</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> texture<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Texture</span><span class="token punctuation">,</span>
    <span class="token keyword">pub</span> view<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureView</span><span class="token punctuation">,</span>
    <span class="token keyword">pub</span> sampler<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Sampler</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Texture</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">from_bytes</span><span class="token punctuation">(</span>
        device<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Device</span><span class="token punctuation">,</span>
        queue<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Queue</span><span class="token punctuation">,</span>
        bytes<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span><span class="token keyword">u8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
        label<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span>
    <span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> img <span class="token operator">=</span> <span class="token namespace">image<span class="token punctuation">::</span></span><span class="token function">load_from_memory</span><span class="token punctuation">(</span>bytes<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
        <span class="token keyword">Self</span><span class="token punctuation">::</span><span class="token function">from_image</span><span class="token punctuation">(</span>device<span class="token punctuation">,</span> queue<span class="token punctuation">,</span> <span class="token operator">&amp;</span>img<span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>label<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">from_image</span><span class="token punctuation">(</span>
        device<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Device</span><span class="token punctuation">,</span>
        queue<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Queue</span><span class="token punctuation">,</span>
        img<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token namespace">image<span class="token punctuation">::</span></span><span class="token class-name">DynamicImage</span><span class="token punctuation">,</span>
        label<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token operator">&gt;</span>
    <span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">Self</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> rgba <span class="token operator">=</span> img<span class="token punctuation">.</span><span class="token function">as_rgba8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> dimensions <span class="token operator">=</span> img<span class="token punctuation">.</span><span class="token function">dimensions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> size <span class="token operator">=</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Extent3d</span> <span class="token punctuation">{</span>
            width<span class="token punctuation">:</span> dimensions<span class="token number">.0</span><span class="token punctuation">,</span>
            height<span class="token punctuation">:</span> dimensions<span class="token number">.1</span><span class="token punctuation">,</span>
            depth_or_array_layers<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> texture <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">create_texture</span><span class="token punctuation">(</span>
            <span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureDescriptor</span> <span class="token punctuation">{</span>
                label<span class="token punctuation">,</span>
                size<span class="token punctuation">,</span>
                mip_level_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                sample_count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                dimension<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureDimension</span><span class="token punctuation">::</span><span class="token constant">D2</span><span class="token punctuation">,</span>
                format<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureFormat</span><span class="token punctuation">::</span><span class="token class-name">Rgba8UnormSrgb</span><span class="token punctuation">,</span>
                usage<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureUsages</span><span class="token punctuation">::</span><span class="token constant">TEXTURE_BINDING</span> <span class="token operator">|</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureUsages</span><span class="token punctuation">::</span><span class="token constant">COPY_DST</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

        queue<span class="token punctuation">.</span><span class="token function">write_texture</span><span class="token punctuation">(</span>
            <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">ImageCopyTexture</span> <span class="token punctuation">{</span>
                aspect<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureAspect</span><span class="token punctuation">::</span><span class="token class-name">All</span><span class="token punctuation">,</span>
                texture<span class="token punctuation">:</span> <span class="token operator">&amp;</span>texture<span class="token punctuation">,</span>
                mip_level<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                origin<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">Origin3d</span><span class="token punctuation">::</span><span class="token constant">ZERO</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            rgba<span class="token punctuation">,</span>
            <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">ImageDataLayout</span> <span class="token punctuation">{</span>
                offset<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                bytes_per_row<span class="token punctuation">:</span> <span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">NonZeroU32</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> dimensions<span class="token number">.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                rows_per_image<span class="token punctuation">:</span> <span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">NonZeroU32</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span>dimensions<span class="token number">.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            size<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> view <span class="token operator">=</span> texture<span class="token punctuation">.</span><span class="token function">create_view</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">TextureViewDescriptor</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> sampler <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">create_sampler</span><span class="token punctuation">(</span>
            <span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">SamplerDescriptor</span> <span class="token punctuation">{</span>
                address_mode_u<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">AddressMode</span><span class="token punctuation">::</span><span class="token class-name">ClampToEdge</span><span class="token punctuation">,</span>
                address_mode_v<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">AddressMode</span><span class="token punctuation">::</span><span class="token class-name">ClampToEdge</span><span class="token punctuation">,</span>
                address_mode_w<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">AddressMode</span><span class="token punctuation">::</span><span class="token class-name">ClampToEdge</span><span class="token punctuation">,</span>
                mag_filter<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">FilterMode</span><span class="token punctuation">::</span><span class="token class-name">Linear</span><span class="token punctuation">,</span>
                min_filter<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">FilterMode</span><span class="token punctuation">::</span><span class="token class-name">Nearest</span><span class="token punctuation">,</span>
                mipmap_filter<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">FilterMode</span><span class="token punctuation">::</span><span class="token class-name">Nearest</span><span class="token punctuation">,</span>
                <span class="token punctuation">..</span><span class="token class-name">Default</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token keyword">Self</span> <span class="token punctuation">{</span> texture<span class="token punctuation">,</span> view<span class="token punctuation">,</span> sampler <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ³¨æ„æˆ‘ä»¬è¦ç”¨çº¹ç†è¿”å›ä¸€ä¸ª <code>CommandBuffer</code>ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åŒæ—¶åŠ è½½å¤šä¸ªçº¹ç†ï¼Œç„¶åå†ä¸€æ¬¡æ€§æäº¤æ‰€æœ‰çš„å‘½ä»¤ç¼“å†²åŒºã€‚</p> <p>æˆ‘ä»¬éœ€è¦å°† <code>texture.rs</code> ä½œä¸ºæ¨¡å—å¯¼å…¥ï¼Œæ‰€ä»¥éœ€åœ¨ <code>main.rs</code> é¡¶éƒ¨æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">mod</span> <span class="token module-declaration namespace">texture</span><span class="token punctuation">;</span>
</code></pre></div><p>è¿™æ · <code>new()</code> ä¸­çš„çº¹ç†åˆ›å»ºä»£ç å°±å˜å¾—ç®€å•å¤šäº†ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code>surface<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>device<span class="token punctuation">,</span> <span class="token operator">&amp;</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> diffuse_bytes <span class="token operator">=</span> <span class="token macro property">include_bytes!</span><span class="token punctuation">(</span><span class="token string">&quot;happy-tree.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// CHANGED!</span>
<span class="token keyword">let</span> diffuse_texture <span class="token operator">=</span> <span class="token namespace">texture<span class="token punctuation">::</span></span><span class="token class-name">Texture</span><span class="token punctuation">::</span><span class="token function">from_bytes</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>device<span class="token punctuation">,</span> <span class="token operator">&amp;</span>queue<span class="token punctuation">,</span> diffuse_bytes<span class="token punctuation">,</span> <span class="token string">&quot;happy-tree.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// CHANGED!</span>

<span class="token comment">// æ‰€æœ‰åˆ° `let texture_bind_group_layout = ...` ä¸ºæ­¢çš„éƒ¨åˆ†ç°åœ¨éƒ½å¯ä»¥ç§»é™¤äº†</span>
</code></pre></div><p>æˆ‘ä»¬ä»ç„¶éœ€è¦å•ç‹¬å­˜å‚¨ bind groupï¼Œè¿™æ · <code>Texture</code> å°±ä¸éœ€è¦çŸ¥é“ <code>BindGroup</code> æ˜¯å¦‚ä½•å¸ƒå±€çš„äº†ã€‚è¿™æ ·åˆ›å»º <code>diffuse_bind_group</code> çš„è¿‡ç¨‹ç•¥æœ‰å˜åŒ–ï¼Œä¼šç”¨åˆ° <code>diffuse_texture</code> çš„ <code>view</code> å’Œ <code>sampler</code> å­—æ®µï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">let</span> diffuse_bind_group <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">create_bind_group</span><span class="token punctuation">(</span>
    <span class="token operator">&amp;</span><span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindGroupDescriptor</span> <span class="token punctuation">{</span>
        layout<span class="token punctuation">:</span> <span class="token operator">&amp;</span>texture_bind_group_layout<span class="token punctuation">,</span>
        entries<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token punctuation">[</span>
            <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindGroupEntry</span> <span class="token punctuation">{</span>
                binding<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                resource<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindingResource</span><span class="token punctuation">::</span><span class="token class-name">TextureView</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>diffuse_texture<span class="token punctuation">.</span>view<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// CHANGED!</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindGroupEntry</span> <span class="token punctuation">{</span>
                binding<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                resource<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindingResource</span><span class="token punctuation">::</span><span class="token class-name">Sampler</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>diffuse_texture<span class="token punctuation">.</span>sampler<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// CHANGED!</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        label<span class="token punctuation">:</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">&quot;diffuse_bind_group&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æœ€ååªéœ€æ›´æ–° <code>State</code> å­—æ®µï¼Œå°±å¯ä»¥ç”¨ä¸Šæˆ‘ä»¬é—ªäº®çš„æ–° <code>Texture</code> ç»“æ„äº†ã€‚åœ¨åç»­æ•™ç¨‹ä¸­æˆ‘ä»¬è¿˜ä¼šç”¨åˆ°å®ƒï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">struct</span> <span class="token type-definition class-name">State</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    diffuse_bind_group<span class="token punctuation">:</span> <span class="token namespace">wgpu<span class="token punctuation">::</span></span><span class="token class-name">BindGroup</span><span class="token punctuation">,</span>
    diffuse_texture<span class="token punctuation">:</span> <span class="token namespace">texture<span class="token punctuation">::</span></span><span class="token class-name">Texture</span><span class="token punctuation">,</span> <span class="token comment">// NEW</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">impl</span> <span class="token class-name">State</span> <span class="token punctuation">{</span>
    <span class="token keyword">async</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">Self</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
        <span class="token keyword">Self</span> <span class="token punctuation">{</span>
            <span class="token comment">// ...</span>
            num_indices<span class="token punctuation">,</span>
            diffuse_bind_group<span class="token punctuation">,</span>
            diffuse_texture<span class="token punctuation">,</span> <span class="token comment">// NEW</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å“¦å¼ï¼</p> <p>å¼•å…¥è¿™äº›æ”¹å˜åï¼Œä»£ç çš„å·¥ä½œæ–¹å¼ä»ç„¶å’Œä¹‹å‰ç›¸åŒï¼Œä½†ç°åœ¨æˆ‘ä»¬å°±èƒ½æ›´æ–¹ä¾¿åœ°åˆ›å»ºçº¹ç†äº†ã€‚</p> <h2 id="å°æµ‹éªŒ"><a href="#å°æµ‹éªŒ" class="header-anchor">#</a> å°æµ‹éªŒ</h2> <p>å°è¯•åˆ›å»ºå¦ä¸€ä¸ªçº¹ç†ï¼Œå¹¶åœ¨æŒ‰ä¸‹ç©ºæ ¼é”®æ—¶å°†å…¶æ¢æ‰ã€‚</p> <div class="auto-github-link"><a href="https://github.com/sotrh/learn-wgpu/tree/master/code/beginner/tutorial5-textures/" target="_blank" rel="noopener noreferrer">Check out the code!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">4/30/2022, 10:50:47 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/learn-wgpu-cn/beginner/tutorial4-buffer/" class="prev">
          é¡¶ç‚¹ç¼“å†²åŒºä¸ç´¢å¼•ç¼“å†²åŒº
        </a></span> <span class="next"><a href="/learn-wgpu-cn/beginner/tutorial6-uniforms/">
          Uniform ç¼“å†²åŒºä¸ 3D ç›¸æœº
        </a>
        â†’
      </span></p></div> </main></div></div><div class="global-ui"><!----></div></div>
    <script src="/learn-wgpu-cn/assets/js/app.4ff5359b.js" defer></script><script src="/learn-wgpu-cn/assets/js/4.7de995c5.js" defer></script><script src="/learn-wgpu-cn/assets/js/8.24d6fd2e.js" defer></script><script src="/learn-wgpu-cn/assets/js/25.997fcfd2.js" defer></script>
  </body>
</html>
